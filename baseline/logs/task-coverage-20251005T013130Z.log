[coverage] syncing dependencies
[coverage] erasing previous data
[coverage] running unit tests
===================================================== test session starts ======================================================
platform linux -- Python 3.12.10, pytest-8.4.2, pluggy-1.6.0 -- /workspace/autoresearch/.venv/bin/python3
cachedir: .pytest_cache
benchmark: 5.1.0 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
hypothesis profile 'default'
rootdir: /workspace/autoresearch
configfile: pytest.ini
plugins: benchmark-5.1.0, hypothesis-6.140.2, anyio-4.11.0, cov-7.0.0, langsmith-0.4.31, httpx-0.35.0, bdd-8.1.0
collecting ... collected 1110 items / 25 deselected / 1085 selected

tests/unit/config/test_loader_types.py::test_load_config_file_returns_defaults_when_missing PASSED                       [  0%]
tests/unit/config/test_loader_types.py::test_load_config_file_rejects_non_mapping PASSED                                 [  0%]
tests/unit/config/test_loader_types.py::test_env_storage_override_round_trips PASSED                                     [  0%]
tests/unit/config/test_loader_types.py::test_storage_defaults PASSED                                                     [  0%]
tests/unit/config/test_loader_types.py::test_minimum_resident_nodes_default_without_warning PASSED                       [  0%]
tests/unit/config/test_loader_types.py::test_normalize_ranking_weights_balances_missing_values PASSED                    [  0%]
tests/unit/config/test_loader_types.py::test_config_model_deep_copy_preserves_storage_settings PASSED                    [  0%]
tests/unit/distributed/test_coordination_properties.py::test_election_converges_to_minimum PASSED                        [  0%]
tests/unit/distributed/test_coordination_properties.py::test_election_requires_identifier PASSED                         [  0%]
tests/unit/distributed/test_coordination_properties.py::test_election_accepts_strings PASSED                             [  0%]
tests/unit/distributed/test_coordination_properties.py::test_message_processing_is_idempotent PASSED                     [  1%]
tests/unit/distributed/test_coordination_properties.py::test_message_processing_returns_copy PASSED                      [  1%]
tests/unit/distributed/test_coordination_properties.py::test_module_exports_helpers PASSED                               [  1%]
tests/unit/distributed/test_coordination_properties.py::test_storage_queue_adapter_accepts_mapping_payloads PASSED       [  1%]
tests/unit/distributed/test_coordination_properties.py::test_storage_queue_adapter_rejects_incompatible_payloads PASSED  [  1%]
tests/unit/distributed/test_coordination_properties.py::test_storage_queue_adapter_accepts_broker_queue PASSED           [  1%]
tests/unit/evaluation/test_harness_typing.py::test_open_duckdb_closes_connection PASSED                                  [  1%]
tests/unit/evidence/test_stability_utils.py::test_aggregate_entailment_scores_stable PASSED                              [  1%]
tests/unit/evidence/test_stability_utils.py::test_aggregate_entailment_scores_unstable PASSED                            [  1%]
tests/unit/evidence/test_stability_utils.py::test_sample_paraphrases_returns_unique_variants PASSED                      [  1%]
tests/unit/knowledge/test_graph_pipeline.py::test_session_graph_pipeline_ingest_records_provenance PASSED                [  1%]
tests/unit/knowledge/test_graph_pipeline.py::test_session_graph_pipeline_neighbors_uses_storage PASSED                   [  2%]
tests/unit/monitor/test_metrics_endpoint.py::test_metrics_endpoint_decodes_prometheus_payload PASSED                     [  2%]
tests/unit/monitor/test_metrics_endpoint.py::test_metrics_endpoint_coerces_bytearray PASSED                              [  2%]
tests/unit/monitor/test_metrics_endpoint.py::test_metrics_endpoint_handles_memoryview PASSED                             [  2%]
tests/unit/monitor/test_metrics_endpoint.py::test_metrics_endpoint_replaces_invalid_bytes PASSED                         [  2%]
tests/unit/monitor/test_metrics_endpoint.py::test_metrics_endpoint_handles_failure PASSED                                [  2%]
tests/unit/orchestration/test_answer_audit.py::test_answer_auditor_hedges_unsupported_claims PASSED                      [  2%]
tests/unit/orchestration/test_auto_mode.py::test_auto_mode_returns_direct_answer_when_gate_exits PASSED                  [  2%]
tests/unit/orchestration/test_auto_mode.py::test_auto_mode_escalates_to_debate_when_gate_requires_loops PASSED           [  2%]
tests/unit/orchestration/test_auto_mode.py::test_metrics_record_gate_decision_telemetry PASSED                           [  2%]
tests/unit/orchestration/test_budgeting_algorithm.py::test_budget_scaled_by_loops_and_limits PASSED                      [  2%]
tests/unit/orchestration/test_budgeting_algorithm.py::test_budget_minimum_buffer_applied PASSED                          [  3%]
tests/unit/orchestration/test_budgeting_algorithm.py::test_budget_unchanged_within_bounds PASSED                         [  3%]
tests/unit/orchestration/test_circuit_breaker_determinism.py::test_circuit_breaker_determinism_and_recovery PASSED       [  3%]
tests/unit/orchestration/test_circuit_breaker_thresholds.py::test_circuit_breaker_threshold_and_recovery PASSED          [  3%]
tests/unit/orchestration/test_gate_policy.py::test_scout_gate_reduces_loops_when_signals_low PASSED                      [  3%]
tests/unit/orchestration/test_gate_policy.py::test_scout_gate_respects_force_debate_override PASSED                      [  3%]
tests/unit/orchestration/test_gate_policy.py::test_scout_gate_flags_coverage_gap_and_confidence PASSED                   [  3%]
tests/unit/orchestration/test_gate_policy.py::test_scout_gate_applies_graph_thresholds PASSED                            [  3%]
tests/unit/orchestration/test_metrics_graph_summary.py::test_graph_summary_uses_typed_floats PASSED                      [  3%]
tests/unit/orchestration/test_metrics_graph_summary.py::test_graph_build_skips_empty_payload PASSED                      [  3%]
tests/unit/orchestration/test_metrics_graph_summary.py::test_graph_ingestion_saved_payload_is_sanitized PASSED           [  3%]
tests/unit/orchestration/test_model_routing.py::test_routing_records_constraints_without_switching PASSED                [  4%]
tests/unit/orchestration/test_model_routing.py::test_summary_reports_agent_constraints PASSED                            [  4%]
tests/unit/orchestration/test_orchestration_simulations.py::test_circuit_breaker_sim_is_deterministic PASSED             [  4%]
tests/unit/orchestration/test_orchestration_simulations.py::test_parallel_execution_sim_is_deterministic PASSED          [  4%]
tests/unit/orchestration/test_orchestration_simulations.py::test_cli_runs_modes PASSED                                   [  4%]
tests/unit/orchestration/test_package_exports.py::test_agent_factory_export PASSED                                       [  4%]
tests/unit/orchestration/test_package_exports.py::test_agent_registry_export PASSED                                      [  4%]
tests/unit/orchestration/test_package_exports.py::test_orchestrator_export PASSED                                        [  4%]
tests/unit/orchestration/test_package_exports.py::test_storage_manager_export PASSED                                     [  4%]
tests/unit/orchestration/test_parallel_execute.py::test_execute_parallel_query_error_and_timeout PASSED                  [  4%]
tests/unit/orchestration/test_parallel_execute.py::test_execute_parallel_query_all_fail PASSED                           [  4%]
tests/unit/orchestration/test_parallel_merge_invariant.py::test_parallel_merge_invariant PASSED                          [  5%]
tests/unit/orchestration/test_query_state_features.py::test_query_state_cloudpickle_serialization_preserves_fields PASSED [  5%]
tests/unit/orchestration/test_query_state_features.py::test_query_state_registry_clone_produces_independent_copies PASSED [  5%]
tests/unit/orchestration/test_query_state_features.py::test_query_state_model_copy_deep_clone_separates_mutable_data PASSED [  5%]
tests/unit/orchestration/test_query_state_features.py::test_query_state_registry_update_refreshes_snapshots PASSED       [  5%]
tests/unit/orchestration/test_reverify.py::test_reverify_extracts_claims_and_retries PASSED                              [  5%]
tests/unit/orchestration/test_reverify.py::test_reverify_supplies_fact_checker_defaults PASSED                           [  5%]
tests/unit/orchestration/test_reverify.py::test_reverify_respects_fact_checker_opt_out PASSED                            [  5%]
tests/unit/orchestration/test_state_registry.py::test_register_and_clone_preserve_lock_and_metadata_types PASSED         [  5%]
tests/unit/orchestration/test_state_registry.py::test_config_model_deep_copy_with_embedded_lock PASSED                   [  5%]
tests/unit/orchestration/test_state_registry.py::test_update_replaces_snapshot_and_preserves_lock_integrity PASSED       [  5%]
tests/unit/orchestration/test_state_registry.py::test_update_creates_snapshot_when_missing_identifier PASSED             [  6%]
tests/unit/orchestration/test_state_registry.py::test_registry_round_trip_rehydrates_state_with_fresh_lock PASSED        [  6%]
tests/unit/orchestration/test_task_coordinator.py::test_task_coordinator_schedules_dependencies PASSED                   [  6%]
tests/unit/orchestration/test_task_coordinator.py::test_schedule_next_applies_tie_breakers PASSED                        [  6%]
tests/unit/orchestration/test_task_graph_enhancements.py::test_task_graph_from_planner_output_preserves_dependency_metadata PASSED [  6%]
tests/unit/orchestration/test_task_graph_enhancements.py::test_query_state_normalises_socratic_checks_and_overview PASSED [  6%]
tests/unit/orchestration/test_task_graph_enhancements.py::test_task_coordinator_uses_depth_and_affinity PASSED           [  6%]
tests/unit/orchestration/test_token_utils.py::test_execute_with_adapter_kwarg PASSED                                     [  6%]
tests/unit/orchestration/test_token_utils.py::test_execute_with_mutation_hooks_restores_original PASSED                  [  6%]
tests/unit/orchestration/test_token_utils.py::test_execute_without_adapter_hooks PASSED                                  [  6%]
tests/unit/orchestration/test_token_utils.py::test_execute_raises_for_non_mapping_result PASSED                          [  7%]
tests/unit/orchestration/test_token_utils.py::test_type_guards_detect_adapter_features PASSED                            [  7%]
tests/unit/orchestration/test_token_utils.py::test_is_agent_execution_result_guard PASSED                                [  7%]
tests/unit/orchestration/test_utils_confidence.py::test_metrics_snapshot_parses_token_usage PASSED                       [  7%]
tests/unit/orchestration/test_utils_confidence.py::test_confidence_adjusts_with_metrics_payload PASSED                   [  7%]
tests/unit/orchestration/test_utils_confidence.py::test_graph_metrics_payload_is_sanitized PASSED                        [  7%]
tests/unit/search/test_adaptive_rewrite.py::test_external_lookup_triggers_query_rewrite PASSED                           [  7%]
tests/unit/search/test_adaptive_rewrite.py::test_external_lookup_adaptive_k_increases_fetch PASSED                       [  7%]
tests/unit/search/test_adaptive_rewrite.py::test_query_strategy_markers_disabled PASSED                                  [  7%]
tests/unit/search/test_adaptive_rewrite.py::test_self_critique_markers_disabled PASSED                                   [  7%]
tests/unit/search/test_property_ranking_monotonicity.py::test_monotonic_ranking PASSED                                   [  7%]
tests/unit/search/test_query_expansion_convergence.py::test_query_expansion_converges PASSED                             [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_reset_instance_creates_new_singleton PASSED                  [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_extract_entities_with_spacy PASSED                           [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_build_topic_model_with_insufficient_docs PASSED              [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_try_imports_disabled PASSED                                  [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_try_import_sentence_transformers_success PASSED              [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_search_embedding_protocol_prefers_embed PASSED               [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_search_embedding_protocol_falls_back_to_encode PASSED        [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_search_sentence_transformer_fallback_cached PASSED           [  8%]
tests/unit/search/test_query_expansion_convergence.py::test_search_embedding_backend_switches_without_reset PASSED       [  8%]
tests/unit/search/test_ranking_convergence_simulation.py::test_ranking_converges SKIPPED (CollectorRegistry duplication
in test environment)                                                                                                     [  8%]
tests/unit/search/test_ranking_convergence_simulation.py::test_invalid_weights_raise SKIPPED (CollectorRegistry
duplication in test environment)                                                                                         [  9%]
tests/unit/search/test_ranking_formula.py::test_combine_scores_weighted_sum PASSED                                       [  9%]
tests/unit/search/test_ranking_formula.py::test_combine_scores_requires_convex_weights PASSED                            [  9%]
tests/unit/search/test_ranking_formula.py::test_duckdb_scores_used_without_semantic PASSED                               [  9%]
tests/unit/search/test_ranking_formula.py::test_rank_results_weighted_combination PASSED                                 [  9%]
tests/unit/search/test_ranking_formula.py::test_rank_results_weight_fallback PASSED                                      [  9%]
tests/unit/search/test_session_retry.py::test_http_session_retries_and_reuse PASSED                                      [  9%]
tests/unit/search/test_session_retry.py::test_http_session_recovery PASSED                                               [  9%]
tests/unit/search/test_session_retry.py::test_http_session_adapter_failure PASSED                                        [  9%]
tests/unit/search/test_simulate_rate_limit.py::test_default_backoff PASSED                                               [  9%]
tests/unit/search/test_simulate_rate_limit.py::test_custom_backoff PASSED                                                [  9%]
tests/unit/storage/test_backup_scheduler.py::test_scheduler_runs_backup_and_reschedules PASSED                           [ 10%]
tests/unit/storage/test_backup_scheduler.py::test_scheduler_restarts_existing_timer PASSED                               [ 10%]
tests/unit/storage/test_backup_scheduler.py::test_scheduler_prevents_cancelled_timer_from_rescheduling PASSED            [ 10%]
tests/unit/storage/test_backup_scheduler.py::test_backup_manager_schedule_uses_resolved_scheduler PASSED                 [ 10%]
tests/unit/storage/test_backup_scheduler.py::test_rotation_policy_removes_excess_and_stale_backups PASSED                [ 10%]
tests/unit/storage/test_claim_audit_persistence.py::test_persist_claim_audit_payload_updates_backends PASSED             [ 10%]
tests/unit/storage/test_knowledge_graph.py::test_ingest_persists_exports_and_updates_summary PASSED                      [ 10%]
tests/unit/storage/test_protocols.py::test_to_json_dict_returns_copy PASSED                                              [ 10%]
tests/unit/storage/test_protocols.py::test_init_rdf_store_supports_protocol PASSED                                       [ 10%]
tests/unit/test_a2a_concurrency_sim.py::test_simulation_counts PASSED                                                    [ 10%]
tests/unit/test_a2a_interface.py::test_a2a_message_accepts_sdk_message PASSED                                            [ 10%]
tests/unit/test_a2a_interface.py::test_runtime_requirements_raise PASSED                                                 [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_init PASSED                                                     [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_start PASSED                                                    [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_stop PASSED                                                     [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_handle_query PASSED                                             [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_handle_command_get_capabilities PASSED                          [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_handle_command_get_config PASSED                                [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_handle_command_set_config PASSED                                [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_handle_command_unknown PASSED                                   [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_handle_info PASSED                                              [ 11%]
tests/unit/test_a2a_interface.py::TestA2AInterface::test_handle_query_concurrent PASSED                                  [ 11%]
tests/unit/test_a2a_interface.py::TestA2AClient::test_init PASSED                                                        [ 12%]
tests/unit/test_a2a_interface.py::TestA2AClient::test_query_agent PASSED                                                 [ 12%]
tests/unit/test_a2a_interface.py::TestA2AClient::test_get_agent_capabilities PASSED                                      [ 12%]
tests/unit/test_a2a_interface.py::TestA2AClient::test_get_agent_config PASSED                                            [ 12%]
tests/unit/test_a2a_interface.py::TestA2AClient::test_set_agent_config PASSED                                            [ 12%]
tests/unit/test_a2a_interface.py::test_get_a2a_client PASSED                                                             [ 12%]
tests/unit/test_a2a_interface.py::test_requires_a2a_decorator_available PASSED                                           [ 12%]
tests/unit/test_a2a_interface.py::test_requires_a2a_decorator_not_available PASSED                                       [ 12%]
tests/unit/test_a2a_interface.py::test_handle_query_exception PASSED                                                     [ 12%]
tests/unit/test_a2a_interface.py::test_handle_set_config_invalid PASSED                                                  [ 12%]
tests/unit/test_a2a_interface.py::test_dispatch_simulation_invariants PASSED                                             [ 12%]
tests/unit/test_a2a_interface.py::test_simulation_event_order PASSED                                                     [ 13%]
tests/unit/test_a2a_interface.py::TestA2AClientExtended::test_init PASSED                                                [ 13%]
tests/unit/test_a2a_interface.py::TestA2AClientExtended::test_query_agent PASSED                                         [ 13%]
tests/unit/test_a2a_interface.py::TestA2AClientExtended::test_get_agent_capabilities PASSED                              [ 13%]
tests/unit/test_a2a_interface.py::TestA2AClientExtended::test_get_agent_config PASSED                                    [ 13%]
tests/unit/test_a2a_interface.py::TestA2AClientExtended::test_set_agent_config PASSED                                    [ 13%]
tests/unit/test_a2a_interface.py::TestA2AClientExtended::test_query_agent_error PASSED                                   [ 13%]
tests/unit/test_a2a_mcp_handshake.py::test_handshake_success PASSED                                                      [ 13%]
tests/unit/test_a2a_mcp_handshake.py::test_handshake_timeout PASSED                                                      [ 13%]
tests/unit/test_a2a_mcp_handshake.py::test_handshake_recovery PASSED                                                     [ 13%]
tests/unit/test_a2a_mcp_handshake.py::test_handshake_server_failure PASSED                                               [ 14%]
tests/unit/test_additional_algorithm_docs.py::test_algorithm_docs_exist PASSED                                           [ 14%]
tests/unit/test_additional_coverage.py::test_log_release_tokens_invalid_json PASSED                                      [ 14%]
tests/unit/test_additional_coverage.py::test_circuit_breaker_transitions PASSED                                          [ 14%]
tests/unit/test_additional_coverage.py::test_circuit_breaker_recovery PASSED                                             [ 14%]
tests/unit/test_additional_coverage.py::test_circuit_breaker_success_decrements PASSED                                   [ 14%]
tests/unit/test_additional_coverage.py::test_http_session_reuse_and_close PASSED                                         [ 14%]
tests/unit/test_additional_coverage.py::test_llm_pool_session_reuse PASSED                                               [ 14%]
tests/unit/test_additional_coverage.py::test_llm_pool_adapter_failure PASSED                                             [ 14%]
tests/unit/test_additional_coverage.py::test_set_get_delegate PASSED                                                     [ 14%]
tests/unit/test_additional_coverage.py::test_pop_low_score_missing_confidence PASSED                                     [ 14%]
tests/unit/test_additional_coverage.py::test_output_formatter_invalid PASSED                                             [ 15%]
tests/unit/test_additional_coverage.py::test_streamlit_metrics PASSED                                                    [ 15%]
tests/unit/test_additional_coverage.py::test_render_evaluation_summary_joins_artifacts PASSED                            [ 15%]
tests/unit/test_additional_coverage.py::test_render_evaluation_summary_formats_planner_and_routing PASSED                [ 15%]
tests/unit/test_additional_coverage.py::test_format_percentage_variants PASSED                                           [ 15%]
tests/unit/test_additional_coverage.py::test_cli_utils_format_helpers_importable PASSED                                  [ 15%]
tests/unit/test_advanced_agents.py::test_domain_specialist_execute PASSED                                                [ 15%]
tests/unit/test_advanced_agents.py::test_domain_specialist_can_execute PASSED                                            [ 15%]
tests/unit/test_advanced_agents.py::test_moderator_execute PASSED                                                        [ 15%]
tests/unit/test_advanced_agents.py::test_moderator_can_execute PASSED                                                    [ 15%]
tests/unit/test_advanced_agents.py::test_user_agent_execute PASSED                                                       [ 15%]
tests/unit/test_advanced_agents.py::test_user_agent_can_execute PASSED                                                   [ 16%]
tests/unit/test_advanced_agents.py::test_planner_metadata PASSED                                                         [ 16%]
tests/unit/test_agent_communication.py::test_message_exchange_and_feedback PASSED                                        [ 16%]
tests/unit/test_agent_communication.py::test_coalition_management_in_state PASSED                                        [ 16%]
tests/unit/test_agent_communication.py::test_agent_registry_coalitions PASSED                                            [ 16%]
tests/unit/test_agent_communication.py::test_orchestrator_handles_coalitions PASSED                                      [ 16%]
tests/unit/test_agent_communication.py::test_message_protocols PASSED                                                    [ 16%]
tests/unit/test_agent_registry.py::test_register_and_get_cached_instance PASSED                                          [ 16%]
tests/unit/test_agent_registry.py::test_get_unknown_agent_raises PASSED                                                  [ 16%]
tests/unit/test_agent_registry.py::test_reset_instances PASSED                                                           [ 16%]
tests/unit/test_agents_dialectical.py::test_fact_checker_audit_provenance PASSED                                         [ 16%]
tests/unit/test_agents_dialectical.py::test_synthesizer_support_audit_provenance PASSED                                  [ 17%]
tests/unit/test_agents_llm.py::test_synthesizer_with_injected_adapter PASSED                                             [ 17%]
tests/unit/test_agents_llm.py::test_contrarian_with_injected_adapter PASSED                                              [ 17%]
tests/unit/test_agents_llm.py::test_fact_checker_with_injected_adapter PASSED                                            [ 17%]
tests/unit/test_agents_llm.py::test_agent_factory_with_injected_adapter PASSED                                           [ 17%]
tests/unit/test_agents_llm.py::test_synthesizer_dynamic PASSED                                                           [ 17%]
tests/unit/test_agents_llm.py::test_contrarian_dynamic PASSED                                                            [ 17%]
tests/unit/test_agents_llm.py::test_fact_checker_sources PASSED                                                          [ 17%]
tests/unit/test_algorithm_docs.py::test_algorithm_docs_exist PASSED                                                      [ 17%]
tests/unit/test_algorithm_docs.py::test_core_docstrings_reference_docs PASSED                                            [ 17%]
tests/unit/test_api.py::test_dynamic_limit PASSED                                                                        [ 17%]
tests/unit/test_api.py::test_api_key_roles PASSED                                                                        [ 18%]
tests/unit/test_api.py::test_batch_query_invalid_page PASSED                                                             [ 18%]
tests/unit/test_api.py::test_fallback_no_limit PASSED                                                                    [ 18%]
tests/unit/test_api.py::test_fallback_multiple_ips PASSED                                                                [ 18%]
tests/unit/test_api.py::test_request_log_thread_safety PASSED                                                            [ 18%]
tests/unit/test_api.py::test_query_failure_includes_socratic_reasoning PASSED                                            [ 18%]
tests/unit/test_api_auth_deps.py::test_require_permission_allows PASSED                                                  [ 18%]
tests/unit/test_api_auth_deps.py::test_require_permission_auth_missing PASSED                                            [ 18%]
tests/unit/test_api_auth_deps.py::test_require_permission_forbidden PASSED                                               [ 18%]
tests/unit/test_api_auth_middleware.py::test_resolve_role_valid_key PASSED                                               [ 18%]
tests/unit/test_api_auth_middleware.py::test_resolve_role_invalid_key PASSED                                             [ 18%]
tests/unit/test_api_auth_middleware.py::test_resolve_role_missing_key PASSED                                             [ 19%]
tests/unit/test_api_auth_middleware.py::test_dispatch_invalid_token PASSED                                               [ 19%]
tests/unit/test_api_auth_middleware.py::test_dispatch_valid_token PASSED                                                 [ 19%]
tests/unit/test_api_error_handling.py::test_query_endpoint_runtime_error PASSED                                          [ 19%]
tests/unit/test_api_error_handling.py::test_query_endpoint_invalid_response PASSED                                       [ 19%]
tests/unit/test_api_error_handling.py::test_simulate_api_auth_error_rates PASSED                                         [ 19%]
tests/unit/test_api_errors.py::test_handle_rate_limit_response PASSED                                                    [ 19%]
tests/unit/test_api_errors.py::test_handle_rate_limit_text PASSED                                                        [ 19%]
tests/unit/test_api_imports.py::test_no_unused_imports PASSED                                                            [ 19%]
tests/unit/test_api_lifespan.py::test_lifespan_startup_shutdown PASSED                                                   [ 19%]
tests/unit/test_api_rate_limit.py::test_initial_burst_and_refill PASSED                                                  [ 20%]
tests/unit/test_api_rate_limit.py::test_partial_refill PASSED                                                            [ 20%]
tests/unit/test_api_rate_limit.py::test_clock_drift PASSED                                                               [ 20%]
tests/unit/test_api_rate_limit.py::test_invalid_parameters PASSED                                                        [ 20%]
tests/unit/test_api_token_utils.py::test_generate_bearer_token_unique PASSED                                             [ 20%]
tests/unit/test_api_token_utils.py::test_verify_bearer_token PASSED                                                      [ 20%]
tests/unit/test_backup_manager.py::test_create_and_restore_backup PASSED                                                 [ 20%]
tests/unit/test_backup_manager.py::test_backup_scheduler_start_stop PASSED                                               [ 20%]
tests/unit/test_bm25_scoring.py::test_calculate_bm25_scores_real_documents PASSED                                        [ 20%]
tests/unit/test_budgeting.py::test_apply_adaptive_token_budget_paths PASSED                                              [ 20%]
tests/unit/test_budgeting_module.py::test_budget_scaled_by_loops_and_capped PASSED                                       [ 20%]
tests/unit/test_budgeting_module.py::test_budget_increased_when_too_low PASSED                                           [ 21%]
tests/unit/test_budgeting_module.py::test_budget_unchanged_when_within_bounds PASSED                                     [ 21%]
tests/unit/test_budgeting_module.py::test_budget_noop_when_missing PASSED                                                [ 21%]
tests/unit/test_cache.py::test_search_uses_cache PASSED                                                                  [ 21%]
tests/unit/test_cache.py::test_cache_lifecycle PASSED                                                                    [ 21%]
tests/unit/test_cache.py::test_setup_thread_safe PASSED                                                                  [ 21%]
tests/unit/test_cache.py::test_cache_is_backend_specific PASSED                                                          [ 21%]
tests/unit/test_cache.py::test_cache_is_backend_specific_without_embeddings PASSED                                       [ 21%]
tests/unit/test_cache.py::test_cache_key_normalizes_queries PASSED                                                       [ 21%]
tests/unit/test_cache.py::test_cache_key_respects_embedding_flags PASSED                                                 [ 21%]
tests/unit/test_cache.py::test_context_aware_query_expansion_uses_cache PASSED                                           [ 21%]
tests/unit/test_cache_deepcopy.py::test_cache_results_are_deepcopied PASSED                                              [ 22%]
tests/unit/test_cache_deepcopy.py::test_get_cache_returns_singleton PASSED                                               [ 22%]
tests/unit/test_cache_extra.py::test_get_db_after_teardown PASSED                                                        [ 22%]
tests/unit/test_check_env_warnings.py::test_missing_package_metadata_raises PASSED                                       [ 22%]
tests/unit/test_check_env_warnings.py::test_missing_pytest_bdd_raises PASSED                                             [ 22%]
tests/unit/test_check_env_warnings.py::test_missing_go_task_raises PASSED                                                [ 22%]
tests/unit/test_check_env_warnings.py::test_missing_uv_raises_version_error PASSED                                       [ 22%]
tests/unit/test_check_env_warnings.py::test_task_command_failure PASSED                                                  [ 22%]
tests/unit/test_check_env_warnings.py::test_main_reports_missing_metadata PASSED                                         [ 22%]
tests/unit/test_check_env_warnings.py::test_env_metadata_provider PASSED                                                 [ 22%]
tests/unit/test_circuit_breaker_module.py::test_state_transitions PASSED                                                 [ 22%]
tests/unit/test_circuit_breaker_module.py::test_recovery PASSED                                                          [ 23%]
tests/unit/test_cli_backup_extra.py::test_format_size_units PASSED                                                       [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_create_error PASSED                                                     [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_create_missing_tables PASSED                                            [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_create_success PASSED                                                   [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_restore_cancelled PASSED                                                [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_restore_error PASSED                                                    [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_list_no_backups PASSED                                                  [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_list_success PASSED                                                     [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_recover_invalid_timestamp PASSED                                        [ 23%]
tests/unit/test_cli_backup_extra.py::test_backup_recover_error PASSED                                                    [ 23%]
tests/unit/test_cli_help.py::test_cli_help_no_ansi PASSED                                                                [ 24%]
tests/unit/test_cli_help.py::test_search_help_includes_interactive PASSED                                                [ 24%]
tests/unit/test_cli_help.py::test_search_help_includes_visualize PASSED                                                  [ 24%]
tests/unit/test_cli_help.py::test_search_loops_option PASSED                                                             [ 24%]
tests/unit/test_cli_help.py::test_search_help_includes_ontology_flags PASSED                                             [ 24%]
tests/unit/test_cli_help.py::test_visualize_help_includes_layout PASSED                                                  [ 24%]
tests/unit/test_cli_helpers.py::test_find_similar_commands_basic PASSED                                                  [ 24%]
tests/unit/test_cli_helpers.py::test_find_similar_commands_default_threshold PASSED                                      [ 24%]
tests/unit/test_cli_helpers.py::test_parse_agent_groups_parses_nested_lists PASSED                                       [ 24%]
tests/unit/test_cli_helpers.py::test_find_similar_commands_respects_threshold PASSED                                     [ 24%]
tests/unit/test_cli_helpers.py::test_parse_agent_groups_discards_empty_groups PASSED                                     [ 24%]
tests/unit/test_cli_helpers.py::test_require_api_key_missing_header PASSED                                               [ 25%]
tests/unit/test_cli_helpers.py::test_require_api_key_accepts_present_header PASSED                                       [ 25%]
tests/unit/test_cli_helpers.py::test_report_missing_tables_sorts_and_prints PASSED                                       [ 25%]
tests/unit/test_cli_helpers.py::test_report_missing_tables_uses_console PASSED                                           [ 25%]
tests/unit/test_cli_helpers.py::test_handle_command_not_found_suggests_similar PASSED                                    [ 25%]
tests/unit/test_cli_helpers.py::test_install_help_text_in_readme PASSED                                                  [ 25%]
tests/unit/test_cli_utils.py::test_attach_cli_hooks_exposes_attributes PASSED                                            [ 25%]
tests/unit/test_cli_utils_extra.py::test_print_error_suggestion PASSED                                                   [ 25%]
tests/unit/test_cli_utils_extra.py::test_verbosity_roundtrip PASSED                                                      [ 25%]
tests/unit/test_cli_utils_extra.py::test_set_verbosity_sets_env PASSED                                                   [ 25%]
tests/unit/test_cli_utils_extra.py::test_print_error_emits_at_quiet_threshold[quiet] PASSED                              [ 25%]
tests/unit/test_cli_utils_extra.py::test_print_error_emits_at_quiet_threshold[normal] PASSED                             [ 26%]
tests/unit/test_cli_utils_extra.py::test_print_error_emits_at_quiet_threshold[verbose] PASSED                            [ 26%]
tests/unit/test_cli_utils_extra.py::test_print_error_suppressed_when_threshold_higher PASSED                             [ 26%]
tests/unit/test_cli_utils_extra.py::test_print_warning_respects_minimum[quiet-False] PASSED                              [ 26%]
tests/unit/test_cli_utils_extra.py::test_print_warning_respects_minimum[normal-True] PASSED                              [ 26%]
tests/unit/test_cli_utils_extra.py::test_print_warning_respects_minimum[verbose-True] PASSED                             [ 26%]
tests/unit/test_cli_utils_extra.py::test_ascii_and_table_empty PASSED                                                    [ 26%]
tests/unit/test_cli_utils_extra.py::test_format_functions PASSED                                                         [ 26%]
tests/unit/test_cli_visualize.py::test_ascii_bar_graph_basic PASSED                                                      [ 26%]
tests/unit/test_cli_visualize.py::test_summary_table_render PASSED                                                       [ 26%]
tests/unit/test_cli_visualize.py::test_search_visualize_option PASSED                                                    [ 27%]
tests/unit/test_coalition_execution.py::test_coalition_agents_run_together PASSED                                        [ 27%]
tests/unit/test_coalition_execution.py::test_configmodel_from_dict_allows_coalitions PASSED                              [ 27%]
tests/unit/test_config_env_file.py::test_config_spec_exists PASSED                                                       [ 27%]
tests/unit/test_config_env_file.py::test_env_file_parsing PASSED                                                         [ 27%]
tests/unit/test_config_errors.py::test_config_spec_exists PASSED                                                         [ 27%]
tests/unit/test_config_errors.py::test_load_config_file_error PASSED                                                     [ 27%]
tests/unit/test_config_errors.py::test_notify_observers_error PASSED                                                     [ 27%]
tests/unit/test_config_errors.py::test_watch_config_files_error PASSED                                                   [ 27%]
tests/unit/test_config_errors.py::test_watch_config_reload_error PASSED                                                  [ 27%]
tests/unit/test_config_errors.py::test_reset_instance_error PASSED                                                       [ 27%]
tests/unit/test_config_hot_reload_sim.py::test_config_hot_reload_sim PASSED                                              [ 28%]
tests/unit/test_config_hot_reload_sim.py::test_invalid_update_logged PASSED                                              [ 28%]
tests/unit/test_config_loader_defaults.py::test_config_spec_exists PASSED                                                [ 28%]
tests/unit/test_config_loader_defaults.py::test_invalid_env_falls_back_to_defaults PASSED                                [ 28%]
tests/unit/test_config_loader_defaults.py::test_validate_without_config_file PASSED                                      [ 28%]
tests/unit/test_config_profiles.py::test_config_spec_exists PASSED                                                       [ 28%]
tests/unit/test_config_profiles.py::test_config_profiles_default PASSED                                                  [ 28%]
tests/unit/test_config_profiles.py::test_config_profiles_switch PASSED                                                   [ 28%]
tests/unit/test_config_profiles.py::test_config_profiles_invalid PASSED                                                  [ 28%]
tests/unit/test_config_profiles.py::test_config_profiles_merge PASSED                                                    [ 28%]
tests/unit/test_config_reload.py::test_config_spec_exists PASSED                                                         [ 28%]
tests/unit/test_config_reload.py::test_config_reload_on_change PASSED                                                    [ 29%]
tests/unit/test_config_utils.py::test_config_spec_exists PASSED                                                          [ 29%]
tests/unit/test_config_utils.py::test_module_docstring_mentions_spec PASSED                                              [ 29%]
tests/unit/test_config_utils.py::test_apply_preset_returns_configuration PASSED                                          [ 29%]
tests/unit/test_config_utils.py::test_apply_preset_unknown_name PASSED                                                   [ 29%]
tests/unit/test_config_utils.py::test_validate_config_success PASSED                                                     [ 29%]
tests/unit/test_config_utils.py::test_validate_config_failure PASSED                                                     [ 29%]
tests/unit/test_config_validation_errors.py::test_config_spec_exists PASSED                                              [ 29%]
tests/unit/test_config_validation_errors.py::test_invalid_rdf_backend PASSED                                             [ 29%]
tests/unit/test_config_validation_errors.py::test_weights_must_sum_to_one PASSED                                         [ 29%]
tests/unit/test_config_validation_errors.py::test_default_config_loads_without_error PASSED                              [ 29%]
tests/unit/test_config_validators_additional.py::test_config_spec_exists PASSED                                          [ 30%]
tests/unit/test_config_validators_additional.py::test_reasoning_mode_valid[direct-direct0] PASSED                        [ 30%]
tests/unit/test_config_validators_additional.py::test_reasoning_mode_valid[direct-direct1] PASSED                        [ 30%]
tests/unit/test_config_validators_additional.py::test_reasoning_mode_invalid PASSED                                      [ 30%]
tests/unit/test_config_validators_additional.py::test_token_budget_valid[None] PASSED                                    [ 30%]
tests/unit/test_config_validators_additional.py::test_token_budget_valid[10] PASSED                                      [ 30%]
tests/unit/test_config_validators_additional.py::test_token_budget_invalid[0] PASSED                                     [ 30%]
tests/unit/test_config_validators_additional.py::test_token_budget_invalid[-5] PASSED                                    [ 30%]
tests/unit/test_config_validators_additional.py::test_eviction_policy_valid[LRU] PASSED                                  [ 30%]
tests/unit/test_config_validators_additional.py::test_eviction_policy_valid[score] PASSED                                [ 30%]
tests/unit/test_config_validators_additional.py::test_eviction_policy_valid[hybrid] PASSED                               [ 30%]
tests/unit/test_config_validators_additional.py::test_eviction_policy_valid[priority] PASSED                             [ 31%]
tests/unit/test_config_validators_additional.py::test_eviction_policy_valid[adaptive] PASSED                             [ 31%]
tests/unit/test_config_validators_additional.py::test_eviction_policy_invalid PASSED                                     [ 31%]
tests/unit/test_config_watcher_cleanup.py::test_config_spec_exists PASSED                                                [ 31%]
tests/unit/test_config_watcher_cleanup.py::test_cli_watcher_cleanup PASSED                                               [ 31%]
tests/unit/test_config_watcher_cleanup.py::test_api_watcher_cleanup PASSED                                               [ 31%]
tests/unit/test_config_watcher_cleanup.py::test_cli_watcher_cleanup_error PASSED                                         [ 31%]
tests/unit/test_config_watcher_cleanup.py::test_api_watcher_cleanup_error PASSED                                         [ 31%]
tests/unit/test_core_modules_additional.py::test_orchestrator_parse_config_basic PASSED                                  [ 31%]
tests/unit/test_core_modules_additional.py::test_search_stub_backend[legacy] PASSED                                      [ 31%]
tests/unit/test_core_modules_additional.py::test_search_stub_backend[vss-enabled] PASSED                                 [ 31%]
tests/unit/test_core_modules_additional.py::test_search_stub_backend_return_handles_fallback PASSED                      [ 32%]
tests/unit/test_core_modules_additional.py::test_planner_execute PASSED                                                  [ 32%]
tests/unit/test_core_modules_additional.py::test_storage_setup_teardown PASSED                                           [ 32%]
tests/unit/test_core_modules_additional.py::test_storage_setup_without_kuzu PASSED                                       [ 32%]
tests/unit/test_data_analysis.py::test_metrics_dataframe_enabled PASSED                                                  [ 32%]
tests/unit/test_data_analysis.py::test_metrics_dataframe_disabled PASSED                                                 [ 32%]
tests/unit/test_data_analysis.py::test_metrics_dataframe_polars_missing PASSED                                           [ 32%]
tests/unit/test_data_analysis.py::test_metrics_dataframe_reload_without_polars PASSED                                    [ 32%]
tests/unit/test_data_analysis_polars.py::test_metrics_dataframe_summary PASSED                                           [ 32%]
tests/unit/test_distributed.py::test_get_message_broker_invalid PASSED                                                   [ 32%]
tests/unit/test_distributed.py::test_publish_claim_inmemory SKIPPED (multiprocessing Manager unsupported in this
environment)                                                                                                             [ 32%]
tests/unit/test_distributed_broker.py::test_get_message_broker_memory SKIPPED (multiprocessing Manager unsupported in
this environment)                                                                                                        [ 33%]
tests/unit/test_distributed_broker.py::test_get_message_broker_invalid PASSED                                            [ 33%]
tests/unit/test_distributed_broker.py::test_redis_broker_requires_dependency PASSED                                      [ 33%]
tests/unit/test_distributed_broker.py::test_ray_broker_publish PASSED                                                    [ 33%]
tests/unit/test_distributed_broker_import_error.py::test_redis_broker_missing_dependency PASSED                          [ 33%]
tests/unit/test_distributed_coordination_benchmark.py::test_benchmark_scales SKIPPED (multiprocessing Manager
unsupported in this environment)                                                                                         [ 33%]
tests/unit/test_distributed_coordination_benchmark.py::test_benchmark_survives_worker_crash SKIPPED (multiprocessing
Manager unsupported in this environment)                                                                                 [ 33%]
tests/unit/test_distributed_coordination_props.py::test_leader_is_minimum PASSED                                         [ 33%]
tests/unit/test_distributed_coordination_props.py::test_message_ordering_preserved SKIPPED (multiprocessing Manager
unsupported in this environment)                                                                                         [ 33%]
tests/unit/test_distributed_executors.py::test_execute_agent_process_records_queue PASSED                                [ 33%]
tests/unit/test_distributed_executors.py::test_execute_agent_remote SKIPPED (Real Ray clusters require package-level
agent registration; serialization is covered by test_query_state_ray_round_trip.)                                        [ 34%]
tests/unit/test_distributed_executors.py::test_ray_executor_cycle_callback SKIPPED (RayExecutor callback test relies on
the local stub runtime.)                                                                                                 [ 34%]
tests/unit/test_distributed_executors.py::test_process_executor_uses_local_queue PASSED                                  [ 34%]
tests/unit/test_distributed_executors.py::test_query_state_cloudpickle_round_trip PASSED                                 [ 34%]
tests/unit/test_distributed_executors.py::test_query_state_ray_round_trip PASSED                                         [ 34%]
tests/unit/test_distributed_executors.py::test_publish_claim_enqueues_typed_message PASSED                               [ 34%]
tests/unit/test_distributed_extra.py::test_get_message_broker_default SKIPPED (multiprocessing Manager unsupported in
this environment)                                                                                                        [ 34%]
tests/unit/test_distributed_extra.py::test_redis_queue_roundtrip SKIPPED (multiprocessing Manager unsupported in this
environment)                                                                                                             [ 34%]
tests/unit/test_distributed_perf_compare.py::test_compare_matches_theory_within_tolerance PASSED                         [ 34%]
tests/unit/test_distributed_perf_sim_script.py::test_latency_decreases_with_workers PASSED                               [ 34%]
tests/unit/test_distributed_perf_sim_script.py::test_cli_execution PASSED                                                [ 34%]
tests/unit/test_distributed_perf_sim_script.py::test_cli_requires_arguments PASSED                                       [ 35%]
tests/unit/test_distributed_redis.py::test_get_message_broker_redis_roundtrip PASSED                                     [ 35%]
tests/unit/test_distributed_redis.py::test_get_message_broker_redis_missing PASSED                                       [ 35%]
tests/unit/test_download_duckdb_extensions.py::test_download_extension_network_fallback PASSED                           [ 35%]
tests/unit/test_download_duckdb_extensions.py::test_download_extension_creates_stub_when_offline PASSED                  [ 35%]
tests/unit/test_download_duckdb_extensions.py::test_download_extension_offline_without_duckdb PASSED                     [ 35%]
tests/unit/test_download_duckdb_extensions.py::test_download_extension_fallback_path PASSED                              [ 35%]
tests/unit/test_download_duckdb_extensions.py::test_offline_fallback_skips_samefile_copy PASSED                          [ 35%]
tests/unit/test_download_duckdb_extensions.py::test_setup_sh_ignores_smoke_failure_with_stub PASSED                      [ 35%]
tests/unit/test_download_duckdb_extensions.py::test_load_offline_env_sets_vector_extension_path PASSED                   [ 35%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_init PASSED                                    [ 35%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_setup_with_default_path PASSED                 [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_setup_with_custom_path PASSED                  [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_setup_with_connection_error PASSED             [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_setup_table_creation_failure PASSED            [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_setup_missing_extension_continues PASSED       [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_create_tables PASSED                           [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_initialize_schema_version PASSED               [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_get_schema_version PASSED                      [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_get_schema_version_no_version PASSED           [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_update_schema_version PASSED                   [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_run_migrations PASSED                          [ 36%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_has_vss_true PASSED                            [ 37%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_has_vss_false PASSED                           [ 37%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_close PASSED                                   [ 37%]
tests/unit/test_duckdb_storage_backend.py::TestDuckDBStorageBackend::test_clear PASSED                                   [ 37%]
tests/unit/test_duckdb_storage_backend_concurrency.py::test_concurrent_setup_is_idempotent PASSED                        [ 37%]
tests/unit/test_duckdb_storage_backend_concurrency.py::test_initialize_schema_version_failure PASSED                     [ 37%]
tests/unit/test_duckdb_storage_backend_concurrency.py::test_persist_claims_concurrent PASSED                             [ 37%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_create_hnsw_index PASSED      [ 37%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_create_hnsw_index_extension_not_loaded PASSED [ 37%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_create_hnsw_index_error PASSED [ 37%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_persist_claim PASSED          [ 37%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_persist_claim_minimal PASSED  [ 38%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_persist_claim_error PASSED    [ 38%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_vector_search PASSED          [ 38%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_vector_search_vss_not_available PASSED [ 38%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_vector_search_error PASSED    [ 38%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_get_connection PASSED         [ 38%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_get_connection_not_initialized PASSED [ 38%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_update_claim_full_replace PASSED [ 38%]
tests/unit/test_duckdb_storage_backend_extended.py::TestDuckDBStorageBackendExtended::test_update_claim_partial PASSED   [ 38%]
tests/unit/test_error_recovery.py::test_retry_with_backoff_succeeds_on_first_try PASSED                                  [ 38%]
tests/unit/test_error_recovery.py::test_retry_with_backoff_retries_until_success PASSED                                  [ 38%]
tests/unit/test_error_recovery.py::test_retry_with_backoff_raises_after_max_retries PASSED                               [ 39%]
tests/unit/test_error_utils_additional.py::test_error_info_to_dict_and_str PASSED                                        [ 39%]
tests/unit/test_error_utils_additional.py::test_formatters PASSED                                                        [ 39%]
tests/unit/test_error_utils_additional.py::test_timeout_sets_warning PASSED                                              [ 39%]
tests/unit/test_error_utils_additional.py::test_redacted_context_preserved PASSED                                        [ 39%]
tests/unit/test_error_utils_additional.py::test_get_error_info[exc0-Check your configuration file] PASSED                [ 39%]
tests/unit/test_error_utils_additional.py::test_get_error_info[exc1-API key] PASSED                                      [ 39%]
tests/unit/test_error_utils_additional.py::test_get_error_info[exc2-5] PASSED                                            [ 39%]
tests/unit/test_errors.py::test_error_hierarchy PASSED                                                                   [ 39%]
tests/unit/test_errors.py::test_error_messages PASSED                                                                    [ 39%]
tests/unit/test_errors.py::test_error_with_cause PASSED                                                                  [ 40%]
tests/unit/test_errors.py::test_timeout_error PASSED                                                                     [ 40%]
tests/unit/test_errors.py::test_not_found_error PASSED                                                                   [ 40%]
tests/unit/test_eviction.py::test_ram_eviction_skips_without_metrics PASSED                                              [ 40%]
tests/unit/test_eviction.py::test_ram_eviction PASSED                                                                    [ 40%]
tests/unit/test_eviction.py::test_score_eviction PASSED                                                                  [ 40%]
tests/unit/test_eviction.py::test_lru_eviction_order PASSED                                                              [ 40%]
tests/unit/test_eviction.py::test_lru_eviction_sequence PASSED                                                           [ 40%]
tests/unit/test_eviction.py::test_lru_eviction_with_vss_two_passes PASSED                                                [ 40%]
tests/unit/test_eviction.py::test_lru_eviction_with_vss_fallback_preserves_survivors PASSED                              [ 40%]
tests/unit/test_eviction.py::test_lru_eviction_respects_minimum_survivors PASSED                                         [ 40%]
tests/unit/test_eviction.py::test_deterministic_override_clamped_to_minimum PASSED                                       [ 41%]
tests/unit/test_eviction.py::test_initialize_storage_in_memory PASSED                                                    [ 41%]
tests/unit/test_eviction.py::test_initialize_storage_file_path PASSED                                                    [ 41%]
tests/unit/test_examples_package.py::test_sample_configuration PASSED                                                    [ 41%]
tests/unit/test_extras_markers.py::test_nlp_marker PASSED                                                                [ 41%]
tests/unit/test_extras_markers.py::test_ui_marker PASSED                                                                 [ 41%]
tests/unit/test_extras_markers.py::test_vss_marker PASSED                                                                [ 41%]
tests/unit/test_extras_markers.py::test_git_marker PASSED                                                                [ 41%]
tests/unit/test_extras_markers.py::test_distributed_marker PASSED                                                        [ 41%]
tests/unit/test_extras_markers.py::test_analysis_marker PASSED                                                           [ 41%]
tests/unit/test_extras_markers.py::test_llm_marker PASSED                                                                [ 41%]
tests/unit/test_extras_markers.py::test_parsers_marker PASSED                                                            [ 42%]
tests/unit/test_extras_markers.py::test_gpu_marker PASSED                                                                [ 42%]
tests/unit/test_failure_paths.py::test_prompt_registry_unknown PASSED                                                    [ 42%]
tests/unit/test_failure_paths.py::test_prompt_render_missing_variable PASSED                                             [ 42%]
tests/unit/test_failure_paths.py::test_check_agent_can_execute_false PASSED                                              [ 42%]
tests/unit/test_failure_paths.py::test_external_lookup_unknown_backend PASSED                                            [ 42%]
tests/unit/test_failure_paths.py::test_vector_search_vss_unavailable PASSED                                              [ 42%]
tests/unit/test_failure_paths.py::test_query_endpoint_validation_error PASSED                                            [ 42%]
tests/unit/test_failure_scenarios.py::test_external_lookup_network_failure PASSED                                        [ 42%]
tests/unit/test_failure_scenarios.py::test_external_lookup_unknown_backend PASSED                                        [ 42%]
tests/unit/test_failure_scenarios.py::test_external_lookup_fallback PASSED                                               [ 42%]
tests/unit/test_failure_scenarios.py::test_external_lookup_fallback_templated_query PASSED                               [ 43%]
tests/unit/test_failure_scenarios.py::test_get_message_broker_invalid PASSED                                             [ 43%]
tests/unit/test_failure_scenarios.py::test_redis_broker_init_failure PASSED                                              [ 43%]
tests/unit/test_formattemplate_property.py::test_formattemplate_render PASSED                                            [ 43%]
tests/unit/test_git_repo_stub.py::test_repo_init_and_commit PASSED                                                       [ 43%]
tests/unit/test_gpu_bertopic_import.py::test_try_import_bertopic_missing PASSED                                          [ 43%]
tests/unit/test_heuristic_properties.py::test_weighted_score_normalization PASSED                                        [ 43%]
tests/unit/test_heuristic_properties.py::test_token_budget_monotonicity PASSED                                           [ 43%]
tests/unit/test_heuristic_properties.py::test_token_budget_monotonicity_deterministic PASSED                             [ 43%]
tests/unit/test_heuristic_properties.py::test_token_budget_zero_usage_regression PASSED                                  [ 43%]
tests/unit/test_http_session.py::test_http_session_lifecycle PASSED                                                      [ 43%]
tests/unit/test_hybridmethod_guard.py::test_hybridmethod_requires_get_instance PASSED                                    [ 44%]
tests/unit/test_hybridmethod_guard.py::test_hybridmethod_class_and_instance_calls PASSED                                 [ 44%]
tests/unit/test_incremental_updates.py::test_refresh_vector_index_calls_backend PASSED                                   [ 44%]
tests/unit/test_incremental_updates.py::test_persist_claim_triggers_index_refresh PASSED                                 [ 44%]
tests/unit/test_incremental_updates.py::test_update_rdf_claim_wrapper PASSED                                             [ 44%]
tests/unit/test_interfaces.py::test_query_state_complies PASSED                                                          [ 44%]
tests/unit/test_interfaces.py::test_custom_state_complies PASSED                                                         [ 44%]
tests/unit/test_interfaces.py::test_incomplete_state_rejected PASSED                                                     [ 44%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_owlrl PASSED                                                 [ 44%]
tests/unit/test_kg_reasoning.py::test_register_reasoner_adds_plugin PASSED                                               [ 44%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_external PASSED                                              [ 44%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_invokes_plugin_once PASSED                                   [ 45%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_preserves_triple_count PASSED                                [ 45%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_external_error PASSED                                        [ 45%]
tests/unit/test_kg_reasoning.py::test_query_with_reasoning PASSED                                                        [ 45%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_without_owlrl PASSED                                         [ 45%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_reload_without_owlrl PASSED                                  [ 45%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_timeout PASSED                                               [ 45%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_keyboard_interrupt PASSED                                    [ 45%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_skips_when_limit_exceeded PASSED                             [ 45%]
tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_unknown PASSED                                               [ 45%]
tests/unit/test_kuzu_polars.py::test_kuzu_backend_roundtrip PASSED                                                       [ 45%]
tests/unit/test_kuzu_polars.py::test_metrics_dataframe PASSED                                                            [ 46%]
tests/unit/test_llm_adapter.py::test_dummy_adapter_generation PASSED                                                     [ 46%]
tests/unit/test_llm_adapter.py::test_lmstudio_adapter PASSED                                                             [ 46%]
tests/unit/test_llm_adapter.py::test_openai_adapter PASSED                                                               [ 46%]
tests/unit/test_llm_adapter.py::test_compress_prompt_falls_back_when_summary_exceeds_budget PASSED                       [ 46%]
tests/unit/test_llm_adapter_validate_model.py::test_validate_model_invalid PASSED                                        [ 46%]
tests/unit/test_llm_adapters.py::test_validate_model_defaults_to_available_first_model PASSED                            [ 46%]
tests/unit/test_llm_adapters.py::test_validate_model_uses_generic_default_when_no_models PASSED                          [ 46%]
tests/unit/test_llm_adapters.py::test_validate_model_rejects_invalid_models PASSED                                       [ 46%]
tests/unit/test_llm_capabilities.py::TestModelCapabilities::test_model_capabilities_creation PASSED                      [ 46%]
tests/unit/test_llm_capabilities.py::TestModelCapabilities::test_to_dict_method PASSED                                   [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_singleton_pattern PASSED                                 [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_provider_caching PASSED                            [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_provider_unknown PASSED                            [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_all_providers PASSED                               [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_get_model_capabilities_with_provider PASSED              [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_get_model_capabilities_without_provider PASSED           [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_get_model_capabilities_not_found PASSED                  [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_get_model_capabilities_search_across_providers PASSED    [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_openrouter_with_api PASSED                         [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_openrouter_without_api_key PASSED                  [ 47%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_openrouter_with_api_error PASSED                   [ 48%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_openai PASSED                                      [ 48%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_lmstudio PASSED                                    [ 48%]
tests/unit/test_llm_capabilities.py::TestCapabilityProber::test_probe_dummy PASSED                                       [ 48%]
tests/unit/test_llm_capabilities.py::TestHelperFunctions::test_get_capability_prober PASSED                              [ 48%]
tests/unit/test_llm_capabilities.py::TestHelperFunctions::test_probe_all_providers_helper PASSED                         [ 48%]
tests/unit/test_llm_capabilities.py::TestHelperFunctions::test_get_model_capabilities_helper PASSED                      [ 48%]
tests/unit/test_llm_docstrings.py::test_module_docstrings PASSED                                                         [ 48%]
tests/unit/test_llm_docstrings.py::test_class_docstrings PASSED                                                          [ 48%]
tests/unit/test_llm_docstrings.py::test_function_docstrings PASSED                                                       [ 48%]
tests/unit/test_llm_pool.py::test_get_session_reuses_existing_instance PASSED                                            [ 48%]
tests/unit/test_local_git_backend.py::test_local_git_backend_searches_repo PASSED                                        [ 49%]
tests/unit/test_logging_shutdown.py::test_stop_watching_after_logging_shutdown PASSED                                    [ 49%]
tests/unit/test_logging_utils.py::test_get_logger PASSED                                                                 [ 49%]
tests/unit/test_logging_utils.py::test_structured_output_and_redaction PASSED                                            [ 49%]
tests/unit/test_logging_utils.py::test_intercept_handler_handles_closed_stream PASSED                                    [ 49%]
tests/unit/test_logging_utils_env.py::test_configure_logging_from_env PASSED                                             [ 49%]
tests/unit/test_logging_utils_env.py::test_configure_logging_from_env_invalid PASSED                                     [ 49%]
tests/unit/test_main_backup_commands.py::test_backup_create_command PASSED                                               [ 49%]
tests/unit/test_main_backup_commands.py::test_backup_list_command PASSED                                                 [ 49%]
tests/unit/test_main_backup_commands.py::test_backup_restore_command PASSED                                              [ 49%]
tests/unit/test_main_backup_commands.py::test_backup_create_invalid_dir PASSED                                           [ 49%]
tests/unit/test_main_backup_commands.py::test_backup_restore_invalid_path PASSED                                         [ 50%]
tests/unit/test_main_backup_commands.py::test_backup_recover_command PASSED                                              [ 50%]
tests/unit/test_main_backup_commands.py::test_backup_create_error PASSED                                                 [ 50%]
tests/unit/test_main_backup_commands.py::test_backup_create_missing_tables PASSED                                        [ 50%]
tests/unit/test_main_backup_commands.py::test_backup_list_error PASSED                                                   [ 50%]
tests/unit/test_main_backup_commands.py::test_backup_restore_error PASSED                                                [ 50%]
tests/unit/test_main_backup_commands.py::test_backup_schedule_error PASSED                                               [ 50%]
tests/unit/test_main_backup_commands.py::test_backup_recover_error PASSED                                                [ 50%]
tests/unit/test_main_cli.py::test_search_default_output_tty PASSED                                                       [ 50%]
tests/unit/test_main_cli.py::test_search_default_output_json PASSED                                                      [ 50%]
tests/unit/test_main_cli.py::test_search_reasoning_mode_option[direct] PASSED                                            [ 50%]
tests/unit/test_main_cli.py::test_search_reasoning_mode_option[dialectical] PASSED                                       [ 51%]
tests/unit/test_main_cli.py::test_search_primus_start_option PASSED                                                      [ 51%]
tests/unit/test_main_cli.py::test_config_command PASSED                                                                  [ 51%]
tests/unit/test_main_cli.py::test_serve_command PASSED                                                                   [ 51%]
tests/unit/test_main_config_commands.py::test_config_init_command PASSED                                                 [ 51%]
tests/unit/test_main_config_commands.py::test_config_init_command_force PASSED                                           [ 51%]
tests/unit/test_main_config_commands.py::test_config_validate_command_valid PASSED                                       [ 51%]
tests/unit/test_main_config_commands.py::test_config_validate_command_invalid PASSED                                     [ 51%]
tests/unit/test_main_first_run_detection.py::test_first_run_detection_respects_search_paths PASSED                       [ 51%]
tests/unit/test_main_module.py::TestMainModule::test_main_module_direct_execution PASSED                                 [ 51%]
tests/unit/test_main_monitor_commands.py::test_monitor_command PASSED                                                    [ 51%]
tests/unit/test_main_monitor_commands.py::test_serve_a2a_command PASSED                                                  [ 52%]
tests/unit/test_main_monitor_commands.py::test_serve_a2a_command_keyboard_interrupt PASSED                               [ 52%]
tests/unit/test_main_monitor_commands.py::test_monitor_serve_command PASSED                                              [ 52%]
tests/unit/test_main_monitor_commands.py::test_monitor_serve_command_keyboard_interrupt PASSED                           [ 52%]
tests/unit/test_mcp_interface.py::test_client_server_roundtrip PASSED                                                    [ 52%]
tests/unit/test_mcp_interface.py::test_client_server_failure PASSED                                                      [ 52%]
tests/unit/test_metrics.py::test_metrics_collection_and_endpoint PASSED                                                  [ 52%]
tests/unit/test_metrics.py::test_reset_metrics_clears_counters PASSED                                                    [ 52%]
tests/unit/test_metrics_counters.py::test_reset_metrics PASSED                                                           [ 52%]
tests/unit/test_metrics_counters.py::test_temporary_metrics_restores_state PASSED                                        [ 52%]
tests/unit/test_metrics_counters.py::test_get_system_usage_returns_floats PASSED                                         [ 52%]
tests/unit/test_metrics_extra.py::test_cycle_and_agent_metrics PASSED                                                    [ 53%]
tests/unit/test_metrics_extra.py::test_resource_tracking PASSED                                                          [ 53%]
tests/unit/test_metrics_extra2.py::test_get_system_usage_success PASSED                                                  [ 53%]
tests/unit/test_metrics_extra2.py::test_get_system_usage_failure PASSED                                                  [ 53%]
tests/unit/test_metrics_helpers.py::test_mean_last_nonzero PASSED                                                        [ 53%]
tests/unit/test_metrics_helpers.py::test_temporary_metrics_restores_state PASSED                                         [ 53%]
tests/unit/test_metrics_helpers.py::test_record_query_and_tokens PASSED                                                  [ 53%]
tests/unit/test_metrics_heuristics.py::test_compress_prompt_if_needed PASSED                                             [ 53%]
tests/unit/test_metrics_heuristics.py::test_suggest_token_budget PASSED                                                  [ 53%]
tests/unit/test_metrics_misc.py::test_metrics_reset_and_temporary PASSED                                                 [ 53%]
tests/unit/test_metrics_misc.py::test_get_system_usage PASSED                                                            [ 54%]
tests/unit/test_metrics_misc.py::test_token_helpers PASSED                                                               [ 54%]
tests/unit/test_metrics_summary.py::test_metrics_summary[records0] PASSED                                                [ 54%]
tests/unit/test_metrics_summary.py::test_metrics_summary[records1] PASSED                                                [ 54%]
tests/unit/test_metrics_token_budget_extra.py::test_compress_prompt_threshold PASSED                                     [ 54%]
tests/unit/test_metrics_token_budget_extra.py::test_suggest_token_budget_shrink PASSED                                   [ 54%]
tests/unit/test_metrics_token_budget_spec.py::test_compression_threshold_reduces_with_history PASSED                     [ 54%]
tests/unit/test_metrics_token_budget_spec.py::test_token_budget_expands_then_shrinks PASSED                              [ 54%]
tests/unit/test_metrics_token_budget_spec.py::test_budget_shrinks_to_one_after_zero_usage PASSED                         [ 54%]
tests/unit/test_metrics_token_budget_spec.py::test_budget_converges_for_constant_usage PASSED                            [ 54%]
tests/unit/test_metrics_token_budget_spec.py::test_budget_rounds_half_up PASSED                                          [ 54%]
tests/unit/test_metrics_token_budget_spec.py::test_budget_respects_bounds_during_spike PASSED                            [ 55%]
tests/unit/test_metrics_token_budget_spec.py::test_convergence_bound_holds PASSED                                        [ 55%]
tests/unit/test_models_docstrings.py::test_models_spec_exists PASSED                                                     [ 55%]
tests/unit/test_models_docstrings.py::test_module_docstrings PASSED                                                      [ 55%]
tests/unit/test_models_docstrings.py::test_module_docstring_mentions_spec PASSED                                         [ 55%]
tests/unit/test_models_docstrings.py::test_class_docstrings PASSED                                                       [ 55%]
tests/unit/test_monitor_cli.py::test_monitor_prompts_and_passes_callbacks PASSED                                         [ 55%]
tests/unit/test_monitor_cli.py::test_monitor_metrics PASSED                                                              [ 55%]
tests/unit/test_monitor_cli.py::test_monitor_metrics_default_counters PASSED                                             [ 55%]
tests/unit/test_monitor_cli.py::test_metrics_skips_storage PASSED                                                        [ 55%]
tests/unit/test_monitor_cli.py::test_storage_teardown_handles_missing_config PASSED                                      [ 55%]
tests/unit/test_monitor_metrics_init.py::test_monitor_cli_initializes_metrics PASSED                                     [ 56%]
tests/unit/test_more_coverage.py::test_log_sources PASSED                                                                [ 56%]
tests/unit/test_more_coverage.py::test_log_sources_missing PASSED                                                        [ 56%]
tests/unit/test_more_coverage.py::test_persist_claims PASSED                                                             [ 56%]
tests/unit/test_more_coverage.py::test_persist_claims_invalid PASSED                                                     [ 56%]
tests/unit/test_more_coverage.py::test_ndcg_perfect PASSED                                                               [ 56%]
tests/unit/test_more_coverage.py::test_http_session_cycle PASSED                                                         [ 56%]
tests/unit/test_more_coverage.py::test_connection_context_manager_pool PASSED                                            [ 56%]
tests/unit/test_more_coverage.py::test_connection_context_manager_single PASSED                                          [ 56%]
tests/unit/test_more_coverage.py::test_formattemplate_metrics PASSED                                                     [ 56%]
tests/unit/test_more_coverage.py::test_normalize_audit_payload_includes_expected_fields PASSED                           [ 56%]
tests/unit/test_more_coverage.py::test_build_audit_telemetry_summarises_audits PASSED                                    [ 57%]
tests/unit/test_new_modules.py::test_output_formatter_initializes_once PASSED                                            [ 57%]
tests/unit/test_new_modules.py::test_streamlit_log_handler_appends_logs PASSED                                           [ 57%]
tests/unit/test_new_modules.py::test_backup_manager_singleton PASSED                                                     [ 57%]
tests/unit/test_node_health_monitor_property.py::test_check_once_updates_gauges PASSED                                   [ 57%]
tests/unit/test_numpy_stub.py::test_numpy_stub_manual_install PASSED                                                     [ 57%]
tests/unit/test_ontology_reasoner_props.py::test_reasoner_reaches_closure PASSED                                         [ 57%]
tests/unit/test_optimize_weights_unit.py::test_optimize_weights_improves_score PASSED                                    [ 57%]
tests/unit/test_optional_extras.py::test_ui_extra PASSED                                                                 [ 57%]
tests/unit/test_optional_extras.py::test_vss_extra PASSED                                                                [ 57%]
tests/unit/test_optional_extras.py::test_git_extra PASSED                                                                [ 57%]
tests/unit/test_optional_extras.py::test_distributed_extra PASSED                                                        [ 58%]
tests/unit/test_optional_extras.py::test_analysis_extra PASSED                                                           [ 58%]
tests/unit/test_optional_extras.py::test_nlp_extra SKIPPED (nlp extra not installed)                                     [ 58%]
tests/unit/test_optional_extras.py::test_llm_extra PASSED                                                                [ 58%]
tests/unit/test_optional_extras.py::test_parsers_extra PASSED                                                            [ 58%]
tests/unit/test_orchestration_utils_delegation.py::test_get_agent_delegates PASSED                                       [ 58%]
tests/unit/test_orchestration_utils_delegation.py::test_capture_token_usage_delegates PASSED                             [ 58%]
tests/unit/test_orchestration_utils_module.py::test_get_memory_usage_psutil PASSED                                       [ 58%]
tests/unit/test_orchestration_utils_module.py::test_get_memory_usage_fallback PASSED                                     [ 58%]
tests/unit/test_orchestration_utils_module.py::test_calculate_result_confidence PASSED                                   [ 58%]
tests/unit/test_orchestration_utils_module.py::test_calculate_result_confidence_penalties PASSED                         [ 58%]
tests/unit/test_orchestrator_breaker_state_transitions.py::test_breaker_state_sequence PASSED                            [ 59%]
tests/unit/test_orchestrator_budget_and_errors.py::test_adaptive_budget_scales_with_loops PASSED                         [ 59%]
tests/unit/test_orchestrator_budget_and_errors.py::test_error_categorization[exc0-transient] PASSED                      [ 59%]
tests/unit/test_orchestrator_budget_and_errors.py::test_error_categorization[exc1-recoverable] PASSED                    [ 59%]
tests/unit/test_orchestrator_budget_and_errors.py::test_error_categorization[exc2-critical] PASSED                       [ 59%]
tests/unit/test_orchestrator_cb_manager.py::test_circuit_breaker_state_is_instance_isolated PASSED                       [ 59%]
tests/unit/test_orchestrator_circuit_breaker_property.py::test_circuit_breaker_opens_and_recovers PASSED                 [ 59%]
tests/unit/test_orchestrator_edgecases.py::test_get_agent_not_found PASSED                                               [ 59%]
tests/unit/test_orchestrator_edgecases.py::test_parse_config_direct_mode PASSED                                          [ 59%]
tests/unit/test_orchestrator_edgecases.py::test_parse_config_direct_mode_agent_groups PASSED                             [ 59%]
tests/unit/test_orchestrator_errors.py::test_execute_agent_records_errors_and_circuit_breaker PASSED                     [ 60%]
tests/unit/test_orchestrator_errors.py::test_retry_with_backoff_on_transient_error PASSED                                [ 60%]
tests/unit/test_orchestrator_errors.py::test_orchestrator_raises_after_error PASSED                                      [ 60%]
tests/unit/test_orchestrator_errors.py::test_invalid_agent_name_raises PASSED                                            [ 60%]
tests/unit/test_orchestrator_errors.py::test_callback_error_propagates PASSED                                            [ 60%]
tests/unit/test_orchestrator_errors.py::test_agent_error_is_wrapped[ValueError-specific error] PASSED                    [ 60%]
tests/unit/test_orchestrator_errors.py::test_agent_error_is_wrapped[RuntimeError-runtime error] PASSED                   [ 60%]
tests/unit/test_orchestrator_errors.py::test_parallel_query_error_claims PASSED                                          [ 60%]
tests/unit/test_orchestrator_errors.py::test_parallel_query_timeout_claims PASSED                                        [ 60%]
tests/unit/test_orchestrator_helpers.py::test_get_agent_success PASSED                                                   [ 60%]
tests/unit/test_orchestrator_helpers.py::test_get_agent_not_found PASSED                                                 [ 60%]
tests/unit/test_orchestrator_helpers.py::test_call_agent_start_callback PASSED                                           [ 61%]
tests/unit/test_orchestrator_helpers.py::test_persist_claims_logs_storage_error PASSED                                   [ 61%]
tests/unit/test_orchestrator_memory.py::test_get_memory_usage_psutil PASSED                                              [ 61%]
tests/unit/test_orchestrator_memory.py::test_get_memory_usage_fallback PASSED                                            [ 61%]
tests/unit/test_orchestrator_messages.py::test_agents_exchange_messages PASSED                                           [ 61%]
tests/unit/test_orchestrator_order.py::test_custom_agents_order PASSED                                                   [ 61%]
tests/unit/test_orchestrator_order.py::test_async_custom_agents_concurrent PASSED                                        [ 61%]
tests/unit/test_orchestrator_order.py::test_parse_config_direct_mode_groups PASSED                                       [ 61%]
tests/unit/test_orchestrator_parallel_deterministic.py::test_parallel_merging_is_deterministic FAILED                    [ 61%]

=========================================================== FAILURES ===========================================================
____________________________________________ test_parallel_merging_is_deterministic ____________________________________________

    @given(
>       st.lists(
                  
            st.lists(st.text(min_size=1, max_size=3), min_size=1, max_size=2),
            min_size=1,
            max_size=3,
        )
    )

/workspace/autoresearch/tests/unit/test_orchestrator_parallel_deterministic.py:26: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

agent_groups = [['0']]

    @given(
        st.lists(
            st.lists(st.text(min_size=1, max_size=3), min_size=1, max_size=2),
            min_size=1,
            max_size=3,
        )
    )
    @pytest.mark.reasoning_modes
    def test_parallel_merging_is_deterministic(agent_groups):
        """Each group contributes exactly one claim regardless of completion order."""
    
        cfg = ConfigModel(agents=[], loops=1)
    
        def run_with_order(reverse: bool):
            def fake_as_completed(fs, timeout=None):
                items = list(fs)
                if reverse:
                    items.reverse()
                for fut in items:
                    yield fut
    
            with patch("concurrent.futures.as_completed", fake_as_completed):
                with patch.object(Orchestrator, "run_query", DummyOrchestrator().run_query):
                    with patch(
                        "autoresearch.orchestration.parallel.AgentFactory.get",
                        return_value=DummySynthesizer(),
                    ):
                        resp = execute_parallel_query("q", cfg, agent_groups)
            return resp
    
        resp1 = run_with_order(False)
        resp2 = run_with_order(True)
    
        expected = {",".join(g) for g in agent_groups}
>       assert set(resp1.reasoning) == expected
               ^^^^^^^^^^^^^^^^^^^^
E       TypeError: unhashable type: 'dict'
E       Falsifying example: test_parallel_merging_is_deterministic(
E           agent_groups=[['0']],
E       )

/workspace/autoresearch/tests/unit/test_orchestrator_parallel_deterministic.py:59: TypeError
------------------------------------------------------ Captured log call -------------------------------------------------------
INFO     autoresearch.orchestration.parallel:parallel.py:127 {"event": "Agent group ['0'] completed successfully", "timestamp": "2025-10-05T01:32:48.442910Z"}
INFO     autoresearch.orchestration.parallel:parallel.py:148 {"extra": {"execution_time": 0.0028243064880371094, "memory_delta": 0.0, "successful_groups": 1, "error_groups": 0, "timeout_groups": 0}, "event": "Parallel execution completed in 0.00s with memory delta: 0.00MB", "timestamp": "2025-10-05T01:32:48.444117Z"}
INFO     autoresearch.orchestration.parallel:parallel.py:127 {"event": "Agent group ['0'] completed successfully", "timestamp": "2025-10-05T01:32:48.447605Z"}
INFO     autoresearch.orchestration.parallel:parallel.py:148 {"extra": {"execution_time": 0.0021047592163085938, "memory_delta": 0.0, "successful_groups": 1, "error_groups": 0, "timeout_groups": 0}, "event": "Parallel execution completed in 0.00s with memory delta: 0.00MB", "timestamp": "2025-10-05T01:32:48.448682Z"}
INFO     autoresearch.orchestration.parallel:parallel.py:127 {"event": "Agent group ['0'] completed successfully", "timestamp": "2025-10-05T01:32:48.518341Z"}
INFO     autoresearch.orchestration.parallel:parallel.py:148 {"extra": {"execution_time": 0.006546497344970703, "memory_delta": 0.0, "successful_groups": 1, "error_groups": 0, "timeout_groups": 0}, "event": "Parallel execution completed in 0.01s with memory delta: 0.00MB", "timestamp": "2025-10-05T01:32:48.519625Z"}
INFO     autoresearch.orchestration.parallel:parallel.py:127 {"event": "Agent group ['0'] completed successfully", "timestamp": "2025-10-05T01:32:48.522155Z"}
INFO     autoresearch.orchestration.parallel:parallel.py:148 {"extra": {"execution_time": 0.0015976428985595703, "memory_delta": 0.0, "successful_groups": 1, "error_groups": 0, "timeout_groups": 0}, "event": "Parallel execution completed in 0.00s with memory delta: 0.00MB", "timestamp": "2025-10-05T01:32:48.522994Z"}
---------------------------------------------------- Captured log teardown -----------------------------------------------------
INFO     autoresearch.config.loader:loader.py:104 No configuration file found; using defaults
======================================================= warnings summary =======================================================
tests/unit/test_main_config_commands.py:4
  /workspace/autoresearch/tests/unit/test_main_config_commands.py:4: DeprecationWarning: 'importlib.abc.Traversable' is deprecated and slated for removal in Python 3.14
    from importlib.abc import Traversable

tests/unit/knowledge/test_graph_pipeline.py::test_session_graph_pipeline_ingest_records_provenance
  /workspace/autoresearch/.venv/lib/python3.12/site-packages/networkx/readwrite/json_graph/node_link.py:145: FutureWarning: 
  The default value will be `edges="edges" in NetworkX 3.6.
  
  To make this warning go away, explicitly set the edges kwarg, e.g.:
  
    nx.node_link_data(G, edges="links") to preserve current behavior, or
    nx.node_link_data(G, edges="edges") for forward compatibility.
    warnings.warn(

tests/unit/test_kg_reasoning.py::test_run_ontology_reasoner_reload_without_owlrl
  /workspace/autoresearch/src/autoresearch/kg_reasoning.py:60: RuntimeWarning: owlrl not installed; ontology reasoning will be skipped
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
===================================================== slowest 10 durations =====================================================
7.25s call     tests/unit/test_distributed_executors.py::test_query_state_ray_round_trip
7.16s call     tests/unit/test_eviction.py::test_deterministic_override_clamped_to_minimum
1.09s call     tests/unit/test_eviction.py::test_lru_eviction_order
1.00s setup    tests/unit/test_main_backup_commands.py::test_backup_list_command
0.91s setup    tests/unit/test_main_backup_commands.py::test_backup_create_command
0.83s teardown tests/unit/test_errors.py::test_error_messages
0.73s call     tests/unit/distributed/test_coordination_properties.py::test_election_converges_to_minimum
0.72s setup    tests/unit/test_main_backup_commands.py::test_backup_schedule_error
0.72s call     tests/unit/test_cache.py::test_search_uses_cache
0.70s call     tests/unit/test_failure_scenarios.py::test_external_lookup_fallback_templated_query
=================================================== short test summary info ====================================================
FAILED tests/unit/test_orchestrator_parallel_deterministic.py::test_parallel_merging_is_deterministic - TypeError: unhashable type: 'dict'
Falsifying example: test_parallel_merging_is_deterministic(
    agent_groups=[['0']],
)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!! stopping after 1 failures !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
======================= 1 failed, 657 passed, 12 skipped, 25 deselected, 3 warnings in 65.57s (0:01:05) ========================
