# v0.1.0a1 preflight readiness plan (2025-10-08 15:05 UTC)

This revision applies a multi-disciplinary, dialectical, and Socratic
analysis to the current alpha release posture. It replaces the superseded
October 5 snapshot and incorporates the lint fallout observed after the
latest verify sweep.

## October 8, 2025 update (15:03 UTC)

- **Verify sweep status**
  - **Assumption:** The cache fingerprints added earlier in the week stabilised
    Hypothesis property tests enough for a clean release run.
  - **Counterpoint:** `uv run task verify EXTRAS="dev-minimal test"` fails after
    Hypothesis flags `tests/unit/legacy/test_cache.py::`
    `test_interleaved_storage_paths_share_cache` as flaky, so the verify gate
    remains closed.
    【F:baseline/logs/verify_20251008T150125Z.log†L570-L572】
  - **Socratic probe:** Which fixture changes or deterministic seeds will keep
    cache interleaving stable without weakening coverage?
  - **Synthesis:** Lock in deterministic storage source ordering (or introduce
    a deterministic seed hook) before rerunning the full sweep so we can present
    a green verify log in the release dossier.

- **Coverage sweep status**
  - **Assumption:** The collection hygiene guard is satisfied after the
    `from __future__ import annotations` cleanup landed.
  - **Counterpoint:** `uv run task coverage EXTRAS="dev-minimal test"` aborts
    when the guard re-flags `tests/conftest.py`, so pytest stops before coverage
    artefacts or percentages refresh.
    【F:baseline/logs/coverage_20251008T150309Z.log†L452-L498】
  - **Socratic probe:** How do we reconcile the guard with fixtures that still
    require setup code ahead of the future import while keeping the style guide
    intact?
  - **Synthesis:** Investigate `tests/conftest.py` for helper definitions that
    precede the import, refactor them below the guard, and rerun coverage to
    regenerate HTML assets before cutting the alpha tag.

## October 7, 2025 update (16:42 UTC)

- **Strict typing guardrails**
  - **Assumption:** PR-L0a might regress once the next orchestration refactors
    land because AUTO-mode telemetry exercises frozen claim snapshots.
  - **Counterpoint:** A fresh `uv run mypy --strict src tests` sweep returns
    “Success: no issues found in 797 source files,” confirming the gate remains
    green after the latest merges.【0aff6f†L1-L1】
  - **Socratic probe:** Which automated checks keep this guarantee resilient to
    future fixture churn?
  - **Synthesis:** Keep the strict sweep wired into `task check` and add a
    regression test under PR-T0 that asserts AUTO-mode fixtures import the
    frozen reasoning helpers, preventing future `Any` leaks.

- **Pytest collection hygiene**
  - **Assumption:** Restoring the legacy helper modules resolved pytest
    collection failures.
  - **Counterpoint:** `uv run --extra test pytest -q` now fails during
    collection because six modules import standard-library packages before
    `from __future__ import annotations`, triggering SyntaxError and stopping
    the suite.【2fa019†L1-L65】
  - **Socratic probe:** How do we prevent regressions while keeping the fix
    reviewable?
  - **Synthesis:** Land PR-L0b to move `from __future__ import annotations` to
    the top of every affected file, deduplicate redundant imports, and capture a
    fresh quick-gate log. Follow with PR-T0 to add regression coverage that
    fails if duplicate imports sneak ahead of `__future__` directives.

The prior 16:29 UTC snapshot remains relevant for historical context:

## October 7, 2025 update (16:29 UTC)

- **Strict typing regression detection**
  - **Assumption:** The orchestrator and AUTO mode regression suite still kept
    the strict gate green after PR-R0 landed.
  - **Counterpoint:** A fresh `uv run mypy --strict src tests` sweep now fails
    with assignments that store non-string answers in scout samples and unused
    `type: ignore` hints in the AUTO mode regression suite.
    【1fc7a3†L1-L5】
  - **Socratic probe:** Which minimal guard restores immutability guarantees
    without hiding legitimate data types in telemetry?
  - **Synthesis:** Freeze non-string answers through `_freeze_payload`, coerce
    AUTO mode tests to narrow warning and claim payload types, and keep the
    runtime immutability checks via explicit casts. The update preserves
    warning banner stripping and ensures strict typing observes the intended
    immutability contract.
    【F:src/autoresearch/orchestration/orchestrator.py†L108-L134】
    【F:tests/unit/orchestration/test_auto_mode.py†L1-L191】
  - **Evidence:** `uv run mypy --strict src tests` at **16:34 UTC** now returns
    success, confirming the strict gate is green again after the fix.
    【27806b†L1-L1】
- **AUTO mode telemetry invariants**
  - **Assumption:** The regression suite already guaranteed immutability for
    scout samples and warning payloads.
  - **Counterpoint:** Because `Mapping.get` returns `Any`, mypy no longer
    observes attempted mutations; the ignores masked missing invariants.
  - **Socratic probe:** How do we validate runtime immutability while keeping
    strict mode honest?
  - **Synthesis:** Cast to `FrozenReasoningStep` and tupled mappings before
    asserting failures, then confirm telemetry mirrors the scout snapshot to
    lock the immutability guarantees in both typing and runtime checks.
    【F:tests/unit/orchestration/test_auto_mode.py†L78-L164】
  - **Evidence:** The targeted AUTO mode regression suite now passes under
    `uv run --extra test pytest tests/unit/orchestration/test_auto_mode.py -q`,
    confirming warnings and scout answer sanitisation persist for escalation
    flows.【7b397e†L1-L9】

### Short-scope release slices

1. **PR-L0b – Import hygiene fix**
   - Move `from __future__ import annotations` to the top of every module that
     currently fails collection.
   - Drop duplicated standard-library imports so flake8 and pytest agree on the
     ordering.
   - Capture a green `uv run task check` sweep for the release dossier.
2. **PR-T0 – Collection regression guard**
   - Add a pytest-collection smoke test (or Hypothesis health check) that fails
     when duplicate imports precede `__future__` directives.
   - Document the guard in `tests/README.md` and wire it into CI to keep the
     quick gate green.
3. **PR-S3 – Cache determinism**
   - Canonicalise hybrid enrichment queries and rerun the targeted cache
     regression test until `backend.call_count` collapses to one.
   - Extend property coverage for namespace churn and alias upgrades.
4. **PR-L0c – Residual lint cleanup**
   - Eliminate unused imports and newline violations that still block
     `task verify` from reaching mypy and pytest.
   - Archive the post-cleanup quick gate log.
5. **PR-V1 – Evidence refresh**
   - Rerun `task verify` and `task coverage` without GPU extras once the lint
     and cache gates are green.
   - Archive the new logs and update STATUS.md, TASK_PROGRESS.md, and this
     dossier with citations.

Each slice stays under half a day of focused work so reviewers can land them
quickly while the verify gate remains closed.

## Evidence snapshot

- `uv run task verify EXTRAS="dev-minimal test"` at **15:01 UTC on October 8,
  2025** aborts after Hypothesis marks
  `tests/unit/legacy/test_cache.py::test_interleaved_storage_paths_share_cache`
  as flaky, so the verify gate still lacks a passing log for release evidence.
  【F:baseline/logs/verify_20251008T150125Z.log†L570-L572】
- `uv run task coverage EXTRAS="dev-minimal test"` at **15:03 UTC on October 8,
  2025** stops when the future-import guard flags `tests/conftest.py`,
  preventing coverage artefacts and percentage summaries from refreshing.
  【F:baseline/logs/coverage_20251008T150309Z.log†L452-L498】
- `uv run task check` at **04:38 UTC on October 7, 2025** clears `flake8` and the
  repo-wide strict gate before `check_spec_tests.py` lists the missing
  specification anchors, recording the current blocker for the quick gate in
  `baseline/logs/task-check-20251007T0438Z.log`.【F:baseline/logs/task-check-20251007T0438Z.log†L1-L165】
- `uv run task check` at **05:09 UTC on October 7, 2025** now runs to
  completion with regenerated spec anchors, stubbed `docx` fallbacks, and the
  CLI smoke tests passing; the green sweep is archived at
  `baseline/logs/task-check-20251007T050924Z.log`.【F:baseline/logs/task-check-20251007T050924Z.log†L1-L189】
- Summariser, critic, and fact-checker agents now coerce
  `FrozenReasoningStep` payloads into dictionaries before generating prompts,
  and the orchestration state regression extends `ReasoningCollection` via
  another `ReasoningCollection` instance, keeping strict typing green while
  preserving deterministic reasoning order.【F:src/autoresearch/agents/specialized/summarizer.py†L9-L78】
  【F:src/autoresearch/agents/specialized/critic.py†L9-L101】
  【F:src/autoresearch/agents/dialectical/fact_checker.py†L360-L426】
  【F:tests/unit/orchestration/test_query_state_features.py†L140-L160】
- `uv run mypy --strict src tests` at **05:48 UTC on October 7, 2025** reports
  “Success: no issues found in 797 source files”, so the strict gate remains
  green while we focus on pytest regressions.【6bfb2b†L1-L1】
- `uv run mypy --strict src tests` at **16:05 UTC on October 5, 2025** reports
  “Success: no issues found in 205 source files”, keeping the strict gate
  green for alpha triage.【daf290†L1-L2】
- A focused `pytest` target confirms the AUTO mode regression
  (`tests/unit/orchestration/test_auto_mode.py::
  test_auto_mode_returns_direct_answer_when_gate_exits`)
  fails because AUTO mode drops the synthesiser’s claim list, leaving scout
  samples without content; we halted the broad test run after verifying this
  regression to avoid cascading failures.【349e1c†L1-L64】【c59d05†L1-L7】
- `uv run --extra test pytest tests/unit/legacy/test_relevance_ranking.py -k
  external_lookup_uses_cache` fails with `backend.call_count == 3`, keeping
  cache determinism as the primary regression before we can rerun verify and
  coverage.【7821ab†L1031-L1034】
- Fallback placeholders now carry canonical URLs and backend labels via
  `Search._normalise_backend_documents`; `task verify` reaches those assertions
  before the known `test_parallel_merging_is_deterministic` failure recurs,
  confirming search metadata fixes held through the latest sweep.
  【F:src/autoresearch/search/core.py†L842-L918】
  【F:tests/unit/test_core_modules_additional.py†L134-L215】
  【F:tests/unit/test_failure_scenarios.py†L43-L86】
  【F:baseline/logs/task-verify-20251005T012754Z.log†L1-L196】
- Property-based cache probes now enforce deterministic namespace splits and
  confirm backend invocations collapse after the first unique fingerprint, while
  behaviour tests still record warning banners inside final answers, keeping the
  regression clusters prioritised for the next set of PR slices.
  【F:tests/unit/legacy/test_cache.py†L503-L608】【F:tests/unit/legacy/test_cache.py†L779-L879】
  【F:tests/unit/legacy/test_cache.py†L883-L1010】【cf191d†L27-L46】
- A full `uv run --extra test pytest` sweep at **04:53 UTC on October 6, 2025**
  halts during collection with 19 errors. The trace enumerates missing
  `tests/unit/legacy/typing_helpers.py`, `tests/scripts/check_env.py`,
  `tests/scripts/distributed_perf_sim.py`, and
  `tests/scripts/download_duckdb_extensions.py` modules plus the absent
  `tests/baseline/evaluation/scheduler_benchmark.json` fixture referenced by
  the harness.【364b98†L1-L60】
- Regenerated the scheduler benchmark baseline on **October 6, 2025 at
  15:04 UTC** via `uv run scripts/scheduling_resource_benchmark.py --max-workers
  2 --arrival-rate 3 --service-rate 5 --tasks 50 --mem-per-task 0.5`, recording
  throughput and memory floors with provenance metadata for audit reuse.
  【F:baseline/evaluation/scheduler_benchmark.json†L1-L15】
- After wiring the legacy suites to the repository `scripts/` directory and
  shared typing helpers, `uv run --extra test pytest tests/unit/legacy -k cache`
  now collects successfully and reaches the known cache assertion failure,
  confirming fixtures load again.【f1459e†L1-L131】
- A fresh **04:41 UTC on October 6, 2025** `uv run task verify` sweep fails in
  `flake8` with unused imports, duplicate definitions, and newline violations
  introduced by the merged search, cache, and AUTO telemetry changes; mypy and
  pytest do not execute until the lint fallout is resolved.
  【F:baseline/logs/task-verify-20251006T044116Z.log†L1-L124】
- `uv run task check` at **14:38 UTC on October 6, 2025** now clears `flake8`
  and `mypy` before `check_spec_tests.py` lists the long-standing missing
  documentation/test mappings, so lint fallout is resolved while spec coverage
  remains the blocker for a green sweep.
  【F:baseline/logs/task-check-20251006T143809Z.log†L1-L160】
- The paired coverage attempt at **04:41 UTC** starts compiling GPU and
  analysis extras (for example `hdbscan==0.8.40`) and was aborted to preserve
  the evaluation window; the partial log documents the stalled sweep for the
  follow-up run after lint repairs.【F:baseline/logs/task-coverage-20251006T044136Z.log†L1-L8】

## October 7, 2025 triage (05:49 UTC)

- **Spec/test traceability**
  - **Assumption:** Updating `docs/specs/*` with the canonical targets from
    `SPEC_COVERAGE.md` will unblock `check_spec_tests.py` and provide auditable
    traceability before behaviour sweeps resume.
  - **Counterpoint:** The manifest currently references stale paths such as
    `tests/unit/test_api.py`; blindly mirroring those anchors keeps the gate
    red because the files now live under `tests/unit/legacy/`.
  - **Socratic probe:** Which minimal change keeps the manifest and the spec
    footnotes in lock-step after teams reshuffle test modules? A generated
    include or scripted substitution tied to `SPEC_COVERAGE.md` prevents manual
    drift.
  - **Synthesis:** Execute PR-D0 as a documentation+tooling slice: refresh the
    manifest so every `[t*]` pointer resolves to the relocated `legacy` suite,
    add a guard that fails when new anchors go missing, and update each spec
    with the regenerated include before rerunning `uv run task check`.
- **Search cache determinism**
  - **Assumption:** The namespace-aware cache builder introduced in PR-S2 should
    guarantee single-call behaviour for external lookups.
  - **Counterpoint:** A fresh targeted run now fails with `backend.call_count ==
    3`, showing hybrid enrichment still bypasses the cache guard during the
    canonical query swap.【7821ab†L1031-L1034】
  - **Socratic probe:** What evidence will demonstrate the regression is fixed?
    The test must observe `backend.call_count == 1` across seeded namespaces
    and embedding-disabled configs while hybrid telemetry remains intact.
  - **Synthesis:** Prioritise a follow-on PR-S3 that shims the enrichment layer
    to respect cached canonical queries, tighten the property tests around
    `Search._normalise_cache_query`, and document the regression in the cache
    spec once the guard is in place.
- **Docx fallback hygiene**
  - **Assumption:** Installing `python-docx` in the test extra requires the
    manylinux `lxml` wheels baked into the CI image, so local `task check`
    executions will fail unless we compile libxml2 on macOS.
  - **Counterpoint:** The evaluation harness syncs dependencies for the
    manylinux platform to mimic release artefacts, so insisting on locally
    compiled `lxml` creates unnecessary friction for contributors.
  - **Socratic probe:** How can we keep stub coverage without compiling `lxml`
    everywhere? Only attempt to import the real library when it loads
    successfully; otherwise install the existing stub module.
  - **Synthesis:** Ship a defensive import in the `tests.stubs.docx` module so
    missing `lxml` extensions fall back to the stub while CI builds continue to
    exercise the real dependency.

## Dialectical review of active blockers

### Search backend determinism
- **Assumption:** Restoring deterministic request payloads and backend
  signatures will unblock the majority of search failures.
- **Support:** The DuckDuckGo mock rejects the call because the request
  query preserves question punctuation, and the hybrid ranker now invokes
  a patched helper with the wrong arity.【34ebc5†L17-L70】
- **Counterpoint:** Normalising payloads without reviewing cache keys could
  cause hard-to-diagnose mismatches in production telemetry.
- **Synthesis:** Ship a focused PR that (1) reintroduces query canonical
  forms for stubs, (2) restores the cross-backend rank signature and
  adapter hooks, and (3) refreshes unit fixtures to assert both the raw and
  canonical query values.

#### Stub contract
- `ExternalLookupResult` now surfaces `raw_query`, `executed_query`, and
  canonical forms so caches, telemetry, and stubs observe consistent
  payloads.
- Hybrid enrichment pushes query metadata onto the diagnostic stack,
  ensuring `add_embeddings` captures retrieval and fallback phases with
  matching canonical queries.
- Refreshed fixtures cover DuckDuckGo and local file regressions while
  asserting the raw-versus-canonical contract for both stub paths.

### Search cache semantics
- **Assumption:** Cache regressions stemmed from bypassing namespace-aware keys
  when embeddings or storage shims were active.
- **Support:** The refreshed property suite alternates namespaces per draw,
  verifies alias upgrades, and asserts backend invocations plateau after the
  first unique fingerprint, demonstrating the slot builder works as intended.
  【F:tests/unit/legacy/test_cache.py†L503-L608】【F:tests/unit/legacy/test_cache.py†L779-L879】
  【F:tests/unit/legacy/test_cache.py†L883-L1010】
- **Counterpoint:** The suite still exercises a single-process cache; multi-
  process or service-isolated deployments could uncover metadata drift despite
  the helper.
- **Socratic check:** What evidence would show cache keys stay stable across
  processes? Only integration probes that mix namespaces and storage hints under
  separate worker lifecycles will validate the helper beyond unit scope.
- **Synthesis:** Expand integration coverage around the helper, then pair it
  with behaviour telemetry fixes so warning banners no longer leak into final
  answers while the cache remains deterministic.

### Output formatting fidelity
- **Assumption:** OutputFormatter must preserve control characters and
  whitespace to avoid silently corrupting responses.
- **Support:** Hypothesis finds failing cases where control characters are
  dropped from markdown output and where answers collapse to empty strings
  in JSON.【5f96a8†L12-L36】
- **Counterpoint:** Blindly echoing unescaped control characters could break
  downstream renderers or leak unsafe data.
- **Synthesis:** Encode a conservative escaping strategy that preserves
  byte fidelity in JSON while sanitising markdown through explicit code
  fencing, and add property tests that interrogate the escaping rules.

### Specification-test alignment
- **Assumption:** Linking each specification document to its enforcing tests
  is a mechanical documentation sweep that can unblock the quick gate without
  touching runtime code.
- **Support:** `check_spec_tests.py` now fails solely because spec files omit
  anchors despite `SPEC_COVERAGE.md` enumerating the canonical test mapping,
  so synchronising the docs will immediately restore `task check` parity.
  【F:baseline/logs/task-check-20251007T0438Z.log†L102-L165】
- **Counterpoint:** Hand-curating dozens of anchors risks drift the moment new
  tests land, making maintenance brittle.
- **Socratic check:** What evidence proves the mapping remains stable after the
  sweep? An automated include or shortcode that ingests the coverage table will
  keep docs and manifests in lockstep.
- **Synthesis:** Draft **PR-D0** to add templated reference blocks (or a shared
  include) to each spec that mirrors the entries in `SPEC_COVERAGE.md`, update
  the coverage spreadsheet in the same PR, and wire a smoke test that fails if
  the include drifts from the manifest.

### Orchestrator determinism and telemetry
- **Assumption:** Deterministic orchestration is critical for reproducible
  audits and accurate behaviour coverage.
- **Support:** The parallel merge test now raises `TypeError` because
  reasoning steps contain dicts instead of strings, and the benchmarking
  harness fails its throughput floor.【53776f†L22-L34】【53776f†L34-L44】
- **Fresh evidence:** AUTO mode’s early exit no longer hydrates scout claim
  payloads, so behaviour telemetry lacks the structured content the API
  contract promises.【349e1c†L1-L64】
- **Counterpoint:** Tightening determinism without tracing why dicts leak
  into reasoning could hide deeper regressions in agent outputs.
- **Socratic probe:** Which invariant must hold for AUTO mode samples to stay
  truthful? Every sample should expose both the textual answer and the claim
  metadata recorded by the synthesiser; a failing invariant highlights the
  missing persistence hook.
- **Synthesis:** Patch the merge reducer to normalise reasoning payloads,
  hydrate AUTO mode samples with persisted claims, audit the aggregator
  contract with Socratic prompts in tests, and recalibrate the scheduler
  benchmark using recorded baseline metrics rather than hard-coded floors.

### AUTO mode sample hydration
- **Assumption:** Rehydrating the synthesiser’s claims into AUTO mode telemetry
  will unblock both the failing unit test and downstream behaviour checks.
- **Support:** The failing unit test shows that samples currently hold empty
  claim lists even when the synthesiser reports claims through telemetry.
  【349e1c†L1-L64】
- **Counterpoint:** Blindly copying claims may reintroduce the dict leakage that
  broke the parallel merge invariant, so we must constrain the format.
- **Socratic check:** What question reveals whether claim normalisation is safe?
  “Which minimal schema lets behaviour consumers assert claim content without
  mutating orchestrator state?” The answer points to mapping-based snapshots
  independent of live objects.
- **Synthesis:** Introduce a claim snapshot helper that converts synthesiser
  claims into serialisable dataclasses, feed those snapshots into AUTO mode
  metrics, and extend behaviour coverage to assert the schema stays stable.

### Reasoning telemetry hygiene
- **Assumption:** Chain-of-thought answers should remain verbatim, with
  warnings exposed separately.
- **Support:** Behaviour coverage now asserts that CLI answers omit warning
  banners while the JSON payload and metrics mirror the structured warnings,
  preventing silent regressions.【F:tests/behavior/steps/reasoning_modes_auto_cli_cycle_steps.py†L685-L723】
- **Counterpoint:** Removing warnings entirely could reduce user awareness of
  audit gaps, so caution notes must still surface through depth notes and
  metrics.
- **Synthesis:** Strip trailing banners from `results.final_answer` before
  constructing the response and rely on structured telemetry for caution
  delivery, keeping the textual answer clean while preserving warnings for
  downstream renderers.【F:src/autoresearch/orchestration/state.py†L132-L206】

## High-impact readiness priorities (updated 05:49 UTC)

We reassessed the improvement backlog using a dialectical lens, weighing
testability, runtime risk, and release evidence. The following priorities
deliver the greatest impact for v0.1.0a1 readiness while remaining short,
auditable slices.

1. **Restore verify lint parity (PR-L0)**
   - *Assumption:* Quick gate success implies lint is mostly stable.
   - *Counterpoint:* Verify still fails inside `flake8`, so contributors cannot
     gather end-to-end evidence.【F:baseline/logs/task-verify-20251006T044116Z.log†L1-L124】
   - *Socratic probe:* Which minimal edits unblock lint without masking deeper
     issues? Restrict the PR to import ordering, duplicate removal, and
     `__future__` placement.
   - *Synthesis:* Land PR-L0 to unblock verify’s entry point before addressing
     behavioural regressions.
2. **Fix cache determinism (PR-S3)**
   - *Assumption:* Namespace-aware keys should keep backend calls at one per
     query.
   - *Counterpoint:* The latest targeted run still logs three backend calls.
     【7821ab†L1031-L1034】
   - *Socratic probe:* What evidence shows the fix works? The test must assert a
     single call across namespaces and hybrid toggles.
   - *Synthesis:* Implement canonical-query reuse and expand property coverage in
     PR-S3.
3. **Refresh verify and coverage evidence (PR-V1)**
   - *Assumption:* Once lint and cache fixes land, the suite will pass.
   - *Counterpoint:* Coverage remains stuck at the September run because the
     October attempt was aborted mid-install.
     【F:baseline/logs/task-coverage-20251006T044136Z.log†L1-L8】
   - *Socratic probe:* How do we balance runtime with completeness? Rerun without
     GPU extras after lint and cache slices merge.
   - *Synthesis:* Capture new verify/coverage logs and sync all status surfaces.
4. **Harden behaviour evidence (PR-B1)**
   - *Assumption:* Earlier behaviour fixes hold.
   - *Counterpoint:* We still need coverage asserting warning banners stay in
     telemetry once cache determinism changes.
   - *Socratic probe:* Which scenarios prove fidelity? AUTO-mode cache hits,
     reasoning banner separation, and output formatting escapes.
   - *Synthesis:* Add targeted behaviour cases once PR-S3 merges to prevent
     regressions during the sign-off review.
5. **Evidence synchronisation (PR-E1)**
   - *Assumption:* Updating plans is optional after technical fixes.
   - *Counterpoint:* Release reviewers rely on aligned documentation across
     STATUS.md, TASK_PROGRESS.md, CODE_COMPLETE_PLAN.md, and this preflight plan.
   - *Socratic probe:* How do we keep reasoning traceable? Capture each gate’s
     evidence with citations.
   - *Synthesis:* Bundle doc updates in a small PR after new logs land.

## Proposed PR slices

1. **PR-L0 – Verify lint parity**
   - Normalise import ordering, remove duplicates, and restore
     `__future__` placement across affected modules.
   - Document the lint run in STATUS.md and TASK_PROGRESS.md once the gate is
     green.
2. **PR-S3 – Cache determinism guardrails**
   - Enforce canonical-query reuse in `Search.external_lookup` and hybrid
     enrichment.
   - Extend property tests for namespace churn and document the fix in the cache
     spec.
3. **PR-V1 – Verify and coverage refresh**
   - Rerun `task verify` and `task coverage` (without GPU extras), archive logs,
     and update release artefacts with the new evidence.
4. **PR-B1 – Behaviour hardening**
   - Expand behaviour suites for AUTO-mode cache hits, reasoning banner
     separation, and formatter fidelity.
   - Ensure coverage thresholds remain stable after cache changes.
5. **PR-E1 – Evidence synchronisation**
   - Update STATUS.md, TASK_PROGRESS.md, CODE_COMPLETE_PLAN.md, this plan, and
     the alpha issue with fresh logs and dialectical rationales.
   - Include a check that prevents documentation drift (e.g., script or pre-
     commit hook) where feasible.

A follow-up PR sweep (PR-S3) can concentrate on hybrid embedding cache reuse
once S1 and S2 land, while PR-O2 can add documentation updates for formatter
contracts after O1 merges. TestPyPI remains out of scope until these slices
restore a green suite.

## Behaviour and coverage strategy

- Re-run the full behaviour suite after PR-S1 and PR-R1 merge to confirm
  user workflows still capture unmodified answers and warning telemetry.
- Maintain coverage ≥90 % by extending property-based suites with the new
  fixtures introduced above. The search cache property test already seeds a
  coverage gap we will close once the namespace helper lands.【e865e9†L15-L52】
- Document each regression fix in `STATUS.md`, `TASK_PROGRESS.md`, and the
  alpha issue so future reviewers can trace evidence without relying on the
  superseded October 5 logs.

## Immediate next actions

- [ ] Draft **PR-D0** to embed `SPEC_COVERAGE.md` anchors into each spec,
  introduce a reusable include, and update `scripts/check_spec_tests.py` to
  assert the mapping remains in sync with the manifest.
- [x] Land **PR-S1** – deterministic search stubs, hybrid ranking signature
  fixes, and refreshed fixtures are merged; canonical queries now flow through
  the stub contract and hybrid telemetry, and regression coverage keeps the
  contract stable.【F:src/autoresearch/search/core.py†L650-L686】【F:src/autoresearch/search/core.py†L1431-L1468】
  【F:tests/unit/legacy/test_cache.py†L503-L608】【F:tests/unit/legacy/test_cache.py†L779-L879】
- [x] Land **PR-S2** – namespace-aware cache keys and property fixtures are in
  place; Hypothesis now alternates namespaces and asserts backend calls plateau
  after the first unique fingerprint.【F:tests/unit/legacy/test_cache.py†L503-L608】
  【F:tests/unit/legacy/test_cache.py†L779-L879】
- [x] Land **PR-R0** – AUTO mode samples hydrate claim snapshots via the
  reasoning payload normalisers and parallel orchestrator merge, keeping
  telemetry dictionaries serialisable.【F:src/autoresearch/orchestration/reasoning_payloads.py†L1-L166】
  【F:src/autoresearch/orchestration/parallel.py†L191-L210】
- [ ] Draft **PR-O1** to preserve formatting fidelity for JSON and markdown.
- [ ] Draft **PR-R1** to separate warning banners from answer strings where
  behaviour coverage still reports leakage.
- [ ] Draft **PR-P1** to recalibrate scheduler benchmarks now that claim
  hydration and deterministic cache behaviour are merged.
- [x] Land **PR-A1** – specialist agents now normalise `FrozenReasoningStep`
  payloads before prompt construction and the orchestration regression suite
  extends `ReasoningCollection` in-place operations, so `mypy --strict`
  remains green while reasoning order stays deterministic.
- [ ] Repair the lint fallout introduced by PR-S1/S2/R0 so `uv run task verify`
  reaches mypy and pytest again, then rerun coverage with GPU extras disabled
  unless explicitly required.
